---
output: html_document
editor_options: 
  chunk_output_type: inline
---

```{r setup resultados,include=FALSE}
knitr::opts_chunk$set(echo = FALSE,eval = TRUE,message = FALSE,warning = FALSE,cache=TRUE,
                      fig.align='center',tab.align='center')
# pacotes
library(grid)
library(gtable)
library(ggpubr)
library(gt)
library(flextable)
library(dagitty)
library(ggdag)
library(gratia)
# library(sads)
library(doMC)
# library(metR)
library(kableExtra)
library(gridExtra)
library(ggplot2)
theme_set(theme_bw())
library(readr)
# library(purrr)
library(stringr)
library(tidyr)
# library(MuMIn)
# library(AICcmodavg)
# library(insight)
library(bbmle)
library(DHARMa)
# library(mgcv)
library(lme4)
library(data.table)
library(plyr)
library(dplyr)
source("1_to_compile_dissertacao_EM_USO/00_Resultados/figuras_e_tabelas.R")
source("source/general_tools.R")
source("source/GAMMtools.R")
source("source/fig_tools.R")
# tamanho da fonte dos títulos dos gráficos dos resultados por síio de amosttragem (Umed e nCong)
v_titleS <- 1000
v_ncol_fatetwrap <- 14
figHeight=28
figWidth=40
textsize=1
#
f_z <- function(x) (x-mean(x))/sd(x)
##
# df p extensões
df_p_extensoes <- read_csv("dados/csv/df_p_extensoes.csv")
# df dados da proporção de cobertura vegetal
df_p <- read_csv("dados/df_p.csv")
# df dados para simulação
df_sim <- read_csv("dados/df_simulacao.csv") |> 
  inner_join(x=df_p,by="SiteCode")
# df_SoE
df_Usoe.rep <- read_csv("./dados/csv/df_Usoe.csv") |> 
  pivot_longer(cols=`1`:`10`, names_to = "n", values_to = "U") |> 
  inner_join(x=distinct(select(df_sim,SiteCode,effort_ha:S_obs)),by="SiteCode") |> 
  arrange(S_obs,k)
# df_Urep
df_Urep <- list.files(path = "./dados/csv/taxaU/MNEE", pattern = ".csv",recursive = T,full.names = T) %>%  
  adply(.,1,data.table::fread,.id=NULL) %>% na.omit()
# df_Unull
df_Unull <- df_Usoe.rep |> filter(round(lado_km) == 16)
## df_dados_disponiveis
df_dados_disponiveis <- read_csv(file = "dados/df_dados_disponiveis.csv")
## df_resultados 
df_resultados <- read_csv("dados/csv/resultados_MN/df_resultados.csv")
## df_sim
df_sim <- read_csv("dados/df_simulacao.csv")
## df_ad: dados completos, com todos os logOR e as proporções observadas para os 3 e as preditoras
# df_ad <- df_resultados |>
#   arrange(p) |> 
#   inner_join(distinct(select(df_sim,SiteCode,Ntotal:S_obs)),"SiteCode") |> 
#   mutate(diffS = (Smed - S_obs)/S_obs)
## df_contrastes: contrastes por sítio e grau de limitação de dispersão
df_contrastes <- read_csv(file="dados/csv/taxaU/df_contrastes.csv") |> 
  inner_join(df_sim |> select(SiteCode,Ntotal:S_obs) |> distinct(),
             by="SiteCode") |> 
  rename(N=Ntotal,S=S_obs) |> 
  mutate(across(N:S,log,.names="log.{.col}"),
         across(c(p,k,log.N:log.S),f_z,.names = "{.col}_z"),
         SiteCode = factor(SiteCode)) |> 
  select(-c(N:log.S))
## df_md: dados necessários para os modelos
df_md_Uefeito <- df_contrastes %>% 
  select(SiteCode:p, contains("_logratio")) %>% 
  pivot_longer(-c(SiteCode:p)) %>% 
  mutate(name = gsub("_logratio","",name),
         across(c(p,k),f_z,.names = "{.col}_z"),
         SiteCode = factor(SiteCode)) %>% 
  rename("tp_efeito"="name","v_efeito"=value)
## df_newdata
df_newpred <- read_csv(file="dados/csv/df_newpred.csv") |> 
  select(-starts_with("log_"))
## df_congContrastetsREP.cvs
df_contrastes <- df_contrastes %>%
  select(SiteCode:p, contains("_logratio")) %>% 
  mutate(across(-SiteCode,f_z,.names = "{.col}_z")) %>% 
  select(SiteCode,k,p,k_z:frag.total_logratio_z) %>% 
  rename_with(~str_remove(.,"_logratio_z")) %>% 
  pivot_longer(cols = c("area","frag.perse","frag.total"),
               values_to = "Uefeito",
               names_to = "contraste") %>% 
  mutate(contraste = case_when(contraste=="area" ~ "non_frag-ideal",
                               contraste=="frag.total" ~ "contemp-ideal",
                               contraste=="frag.perse" ~ "contemp-non_frag"))
# precisa ainda?
df_plot <- fread("dados/csv/df_plot_geral.csv")
# themes
basic_theme <- function(data, ...){
  data %>% 
    tab_options(
      table.background.color = "white",
      ...
    )
}
## congruência 
df_adSAD <- readRDS("5_resultados/df_adSAD.rds")
df_adSADifself <- adply(c("contemp","ideal","non_frag"),1,\(i){
  df_return <- df_adSAD %>% filter(taxaU==i & land_type==i) %>% 
    select(-land_type,-c(Smed:Smax)) %>% 
    rename("contrafactual"="taxaU",
           "nCong"="nCongKS")
  inner_join(df_return,
             df_contrastes %>% 
               filter(contraste=="non_frag-ideal") %>% 
               select(SiteCode:p,ends_with("_z")),
             by=c("SiteCode","k"))
},.id=NULL)
# tabelas para o texto
# df_quantisobs_Uefeito <- read_csv(file=paste0(v_path,"tabelas/df_quantisobs_Uefeito.csv"))
df_quantisobs_Uefeito <- read_csv(file=paste0("./","tabelas/df_quantisobs_Uefeito.csv"))
l_quants_contrasteU <- lapply(df_quantisobs_Uefeito$`Contraste log(U/U)`,\(i){
  dfi <- df_quantisobs_Uefeito %>% 
    filter(`Contraste log(U/U)`==i) %>% 
    select(1,starts_with("exp"))
  dfi <- dfi %>% select(all_of(grep("0.05|0.95",names(dfi),value = T))) %>% as.data.frame()
  v_return <- dfi[,2] - dfi[,1]
  round(v_return,2)
})
names(l_quants_contrasteU) <- df_quantisobs_Uefeito$`Contraste log(U/U)`
```

```{r trackdown chunk resultados, include=FALSE,eval=FALSE}
# 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
# pacotes
# install.packages("trackdown")
library(trackdown)
# both overwrite: 
# overwrite the current google drive file with the current Rmd:
# upload_file(file="secoes_texto/Resultados/Resultados.Rmd",
#             gpath="mestrado/artigo_principal/secoes_texto/",
#             hide_code=TRUE)
update_file(file ="1_to_compile_dissertacao_EM_USO/00_Resultados/Resultados.Rmd",
            gpath = "mestrado/artigo_principal/secoes_texto/",
            hide_code = TRUE)
# overwrite the current Rmd with the current google drive 
download_file(file = "secoes_texto/Resultados/Resultados.Rmd",
              gpath = "mestrado/artigo_principal/secoes_texto/")
```

## Overview



## Inventários Florestais Simulados

Dos sítios presentes na base de dados TreeCo, 109 estavam dentro dos critérios de seleção (tabela SI 1). As coordenadas dos sítios variaram entre -31° e -7° de latitude e entre -55° e -35° de longitude (fig. \@ref(fig:GE-sitios-amostrados) a). A maioria dos trabalhos foi realizada  em áreas de florestas classificadas como primárias no TreeCo. Apenas 2 sítios possuíam menos de 20 anos de recuperação desde o último grande distúrbio na área e foram removidos (fig. \@ref(fig:GE-sitios-amostrados) c), resultando em 107 sítios. A mediana da área amostrada foi de 1 ha; o número de indivíduos amostrados mediano foi de 1540 indivíduos; a riqueza observada mediana foi de 107 espécies; e o ano de amostragem ou publicação variou entre 1986 e 2016 (fig. \@ref(fig:GE-sitios-amostrados) b). Portanto, todos os 107 sítios possuem paisagens contemporâneas na base de mapas de cobertura vegetal do mapbiomas 6. Não foi possível estimar a taxa U em um sítio com baixa densidade de espécies por número de indivíduos e de baixa proporção de cobertura vegetal na paisagem ao redor (SI). Em outro sítio não foi possível desenhar a parcela quadrado no centro da paisagem devido a configuração espacial da paisagem (SI). Esses dois sítios foram removidos, totalizando 105 sítios simulados.
 

```{r caption GE dados disponiveis,eval=TRUE,include=TRUE}
cap <- "Sítios selecionados na base de dados TreeCo. a) Coordenadas geográficas e proporção de cobertura florestal nas paisagens contemporâneas aos eventos de amostragem com extensão espacial de 4 x 4 km2. b) Características gerais dos inventários, da esquerda para a direita: número de indivíduos amostrados, área da parcela amostrada, número de espécies observado, ano de amostragem. c) Proporção de cobertura florestal na paisagem ao redor da parcela amostrada em função do lado da paisagem ao redor. d) Contagem do número de sítios pelas classes de perturbação usadas no TreeCo, que consideram tanto o tempo desde a última grande perturbação quanto o grau de perturbação ."
```
```{r pring GE dados disponiveis,eval=TRUE,include=TRUE,fig.cap=cap}
knitr::include_graphics(path="./figuras/GE_dados_disponiveis.png")
```

## Efeito escalar da dispersão no mecanismo simulado

O objetivo dessa análise foi avaliar qual a extensão espacial da paisagem é suficiente para simular cada um dos 20 graus de simulação explorados. Para isso as estimativas da taxa U em paisagens prístinas foram obtidas em diferentes extensões espaciais da paisagem, variando de 0.5 km até 16 km de lado da paisagem. Primeiro avaliamos se o padrão da estimativa da taxa U em paisagens com lado 16 km se assemelha ao estimado em paisagens infintas e portanto pode ser usado como uma referência de taxa U sem influência da extensão espacial da paisagem. Então usamos um modelo linear misto para descrever como a média da estimativa U entre sítios variou em função do grau de limitação de dispersão e da extensão espacial da paisagem. Usando esses modelo avaliamos a menor extensão espacial em que a taxa U é próxima da taxa U estimada na paisagem de 16km de lado.

### Estimativa da taxa U na maior extensão espacial da paisagem simulada

```{r}
cap <- "Taxa U estimada na paisagem prístina com 16 km de lado. Cada ponto representa a mediana de 10 réplicas da taxa U por sítio de amostragem e grau de limitação de dispersão (k). As linhas verticais pretas marcam a amplitude interquantil de 90%. As linhas em laranja ligam medianas em um mesmo sítio de amostragem."
```
```{r Unull16km_rep,fig.cap=cap}
knitr::include_graphics("./0_apendices/EfeitoEscala/figuras/fig2a_tendencia_media.png")
```

A média dos sítios de amostragem simulados na paisagem prístina com maior extensão espacial (16 km de lado) é similar ao esperado em paisagens infinitas ()


```{r}
cap <- "Taxa U estimada em paisagens prístina de lado 16 km, separado por sítio de amostragem. Em cada quadro o eixo y é livre para variar em escala. "
```
```{r Uprist16km_site, fig.cap=cap}
# im <- image_trim(image_read("./0_apendices/EfeitoEscala/figuras/fig2_U16_k.png")) %>%
#   image_resize("50%")
# image_write(im,path = "./0_apendices/EfeitoEscala/figuras/fig2_U16_k.png")
knitr::include_graphics("./0_apendices/EfeitoEscala/figuras/fig2_U16_k.png")
```

O padrão por sítio difere do padrão geral da médio, pois a mudança dos valores da taxa U não é sempre continua, pode ocorrer em patamares. Em graus de limitação de dispersão severos a média da taxa U se mantém baixa e com pouca variação entre graus de limitação de dispersão severos, formando um primeiro patamar de valores baixos (Fig Efeito de Escalar 2a e 2b). Com o relaxamento para graus pouco severos, há um salto na média da taxa U, que pode se manter por alguns graus de limitação de dispersão pouco severos (Fig Efeito de Escalar 2a e 2b). Com o maior relaxamento da limitação de dispersão para graus brandos, há a redução gradual da média da taxa U até valores similares ao observado em graus severos de limitação de dispersão (Fig Efeito de Escalar 2a e 2b). O tamanho dos patamares e a forma com que a redução na taxa U ocorre parece depender de uma relação não trivial entre número de indivíduos, número de espécies e grau de limitação de dispersão (figura Efeito de Escalar 2b).


### Estimativa da taxa U sob diferentes escalas espaciais da paisagem prístina

```{r}
cap <- ""
```
```{r}
knitr::include_graphics("./0_apendices/EfeitoEscala/figuras/fig3_Uk_ladoKM.png")
```

### Descrição estatística da relação entre taxa U, grau de limitação de dispersão e extensão espacial da paisagem

Observamos que a extensão espacial mínima adequada tende a aumentar com a redução da limitação de dispersão (Figura 3), exceto em graus de limitação de dispersão pouco severos, nos valores intermediários simulados (Fig Efeito de Escalar 2a e 2b). Nesses graus de limitação de dispersão intermediários há pouca variação na média da taxa U entre escalas e sempre grande variação entre réplicas de uma mesma bateria de simulações (Fig Efeito de Escalar 2a, A1 2b e A1 4b). Quando a proporção de propágulos que permanece até a vizinhança imediata do progenitor (k) varia entre 0.99 e 0.90, a extensão espacial da paisagem adequada é de 1 km de lado (Figura 3). Para k entre 0.80 e 0.55, que corresponde ao campo de parâmetros com máximo global, não é possível determinar uma tendência de redução da média da estimativa de U (Figura 3); a variação entre escalas para um mesmo sítio é baixa (Figuras Efeito de Escalar 2 e A1 3). Em k entre 0.50 e 0.35 a extensão adequada foi de 1 km de lado; entre 0.30 e 0.20, 2 km de lado; e entre 0.15 e 0.05, 4 km de lado (Figura Efeito de Escalar 5 e 6). Pressuposto que a extensão espacial adequada para simular k entre 0.80 e 0.55 pode ser obtida interpolando as escalas adequadas, então nesses graus de limitação de dispersão a extensão suficiente é de 1 km de lado da paisagem ao redor. Uma vez que a paisagem com 4 km de lado foi suficiente para simular todos os graus de limitação de dispersão todas as simulações serão feitas nessa extensão e tambeḿ o calculo da proporção de cobertura florestal. Não simulamos paisagens com lado de 1 km e 2 km, que foram adequadas para os graus de limitação de dispersão de 0.99 até 0.35 e de 0.35 até 0.20, respectivamente.

```{r cap fig5_SoE}
cap <- "A extensão espacial é um dos fatores que determina as medidas tomadas das características da paisagem. No conjunto de áreas analisadas há uma forte relação entre a extensão espacial da paisagem ao redor e a proporção de cobertura vegetal. a). O objetivo do estudo do efeito de escalar foi determinar a extensão espacial adequada para simular os 20 graus de limitação de dispersão. c). Definimos a escala adequada para um grau de limitação de dispersão como a extensão espacial que acumula a maior parte da variação na estimativa da taxa U associada ao aumento da extensão espacial da paisagem ao redor, considerando a amplitude de extensões do lado da paisagem local entre 0.5 km e 16 km. Para detalhes sobre os métodos  do estudo de efeito de escalar veja o apêndice ‘Efeito de Escalar’. Nesse  estudo, 36 sítios foram sorteados e selecionados ao longo do gradiente de número de indivíduos e de espécies na parcela. b). Para esse estudo, as estimativas da taxa U foram simuladas em paisagens totalmente preenchidas com habitat, para descontar o efeito do isolamento estrutural, e explorar apenas o efeito de variar a extensão da paisagem ao redor."
```
```{r figura SoE, eval=TRUE,include=TRUE,fig.cap=cap}
knitr::include_graphics(path = "./0_apendices/EfeitoEscala/figuras/fig2_U16_k.png")
```

## Práticas ontológicas em disputa coexistindo em um sistema epistêmico contrafactual baseado em indivíduos

Nessa seção interpretamos e atribuímos os efeitos da paisagem baseado no contraste de simulações em paisagens contrafactuais. Essas simulações são baseadas no mesmo modelo mecanístico, baseado em indivíduos. Nesse modelo mecanístico, à medida que propágulos entram e saem da parcela, a riqueza e a abundância relativa das espécies locais são influenciadas pela paisagem, que determina a quantidade, posição e distância dos progenitores remanescentes. O modelo é calibrado para capturar a influência da paisagem na riqueza de espécies, expressa na taxa U, levando em conta a limitação de dispersão per capita. Essa taxa corresponde à probabilidade de colonização por uma nova espécie na paisagem necessária para atingir a riqueza observada. A validação empírica ocorre pela avaliação da congruência da distribuição de abundância de espécies (SAD) observada e simulada em um particular contrafactual, e, portanto, considera simultaneamente a influência da paisagem na riqueza e abundância relativa da paisagem. Buscamos quantificar os efeitos da paisagem — área per se, fragmentação per se e fragmentação total — como previstos pelas práticas ontológicas em disputa, na congruência da SAD simulada. Para isso, contrastamos pares de contrafactuais, calculando os efeitos causais médios da paisagem na congruência da SAD simulada (REF ABM causal inference). Esses efeitos foram descritos por modelos hierárquicos aditivos generalizados (HGAMs): o log da razão da chance da SAD simulada ter boa congruência (logOR) em função do log da razão da taxa U (log(U/U)) e da proporção de propágulos que permanecem na vizinhança imediata (k). A seguir apresentamos o log(U/U) estimado em função de k, que interpretamos como métrica funcional de conectividade local (\@ref(metrica-funcional)); e então descrevemos a tendência central dos efeitos da paisagem na congruência da SAD simulada usando modelos hierarquicos (\@ref(efeito-congruencia).

### Métrica funcional da influência da paisagem na biodiversidade local {#metrica-funcional}

Aqui interpretamos como métrica de influência da paisagem na biodiversidade local a razão entre a taxa U estimada nas paisagens contrafactuais em contraste.
Para um mesmo grau de limitação de dispersão, quanto menor a taxa U necessária para obter a riqueza observada, maior é a reposição simulada de espécies pela imigração de propágulos da paisagem ao redor para a parcela. Assim, se o log da razão das taxa U (logU/U) estimadas nas paisagens contrafactuais em contraste for igual a zero não há diferença entre contrafactuais com relação a reposição de espécies locais pela paisagem. Se for positivo, então a paisagem contrafactual no numerador apresenta taxa U superior; e se for negativo o contrário, o denominador apresenta valor superior. 

```{r tabela dos quantis observados dos contrastes}
df_quantisobs_Uefeito <- read_csv(file=paste0("./","tabelas/df_quantisobs_Uefeito.csv"))
# df_quantisobs_Uefeito <- read_csv(file=paste0(v_path,"tabelas/df_quantisobs_Uefeito.csv"))
# df_quantisobs_Uefeito <- df_quantisobs_Uefeito %>% 
#   mutate(`Prática Ontológica` = ifelse(grepl("Frag. total",`Contraste log(U/U)`),
#                                        "Interdependente","Independente")) %>% 
#   relocate(`Prática Ontológica`)
knitr::kable(df_quantisobs_Uefeito,
             caption = "Quantis observados dos contrastes na taxa U previstos em cada prática ontológica.")
```

Cada razão entre taxa Us representa um previsto efeito da paisagem: área per se, fragmentação per se e fragmentação total. 
Nos 3 efeitos, a maior parte dos valores de logU/U ocorre na mesma faixa de valores de paisagens com pouca cobertura florestal, porém em paisagens com perda de cobertura florestal logU/U pode aumentar em magnitude se a limitação de dispersão for branda ou muito severa (fig. \@ref(fig:GE-contraste_taxaU)). Os valores em paisagens sem perda de cobertura florestal ocorrem ao redor do zero, com valores negativos e positivos (fig. \@ref(fig:GE-contraste_taxaU)).
O efeito que apresenta menor amplitude de valores é o de área per se, enquanto o efeito de fragmentação total apresenta a maior amplitude (fig. \@ref(fig:GE-contraste_taxaU)). 
Em alguns sítios, o logU/U do efeito de fragmentação per se pode ser menor do que o observado em paisagens sem perda de cobertura florestal (fig. \@ref(fig:GE-contraste_taxaU)).  
A amplitude dos valores aumenta com a redução do grau de preservação da área amostrada para todos os 3 efeitos (fig. \@ref(fig:GE-contraste_taxaU)). 
Nos graus de limitação de dispersão pouco severos, onde há o máximo global na estimativa da taxa U em paisagens sem perda de habitat (olhar seção ‘Efeito de Escalar’), ocorre a menor variabilidade entre os contrafactuais (fig. \@ref(fig:GE-contraste_taxaU)).

```{r caption figura exploratoria da taxa U}
cap <- "Contrastes na taxa U estimada em pares de paisagens contrafactuais, previstos em cada prática ontológica (tabela X). a) Distribuição dos valores de cada contraste; em vermelhos os quantis de todos os contrastes observados em paisagens com proporção de cobertura florestal igual ou superior 0.95. b) Contraste por sítio de amostragem, pontos ligados pelo sítio de amostragem e coloridos pela proporção de cobertura florestal remanescente."
```
```{r GE-contraste_taxaU, include=TRUE,eval=TRUE,fig.cap=cap}
knitr::include_graphics(path="./figuras/GE_taxaU_contrastes.png")
```

### Descrição dos efeitos da paisagem na congruência da simulação com o padrão empírico {#efeito-congruencia}

Os efeitos causais médios da paisagem foram calculados empíricamente com o log odds ratio (logOR). Quando a congruência da SAD simulada em ambos contrafactuais em contraste é igual, o valor de logOR é zero. Se o contrafactual do numerador apresenta maior proporção de SADs com boa congruência. então o logOR será maior do que zero, vice-e-versa se o logOR for negativo. Nosso objetivo é descrever os efeitos totais da paisagem na congruência relativa da SAD simulada. O sistema epistêmico usado para estimar esses efeitos impõem uma estrutura hierárquica aos dados, pois, simula diversos cenários de dispersão em diferentes tipos de paisagens contrafactuais para cada área amostrada. Nessa situação, dados com estrutura hierarquicas podem ser usados para estimar efeitos causais não enviesados (Feller & Gelman 2015; Weinstein & Blei 2024). A lógica é que, uma vez que o sítio de amostragem é sempre o mesmo, todas as possíveis covariáveis estão fixas. A descrição do logOR em função de k (proporção de propágulos que permanece até a vizinhança imediadata do progenitor) e do logU/U (métrica que expressa o efeito da paisagem) pode descrever o efeito completo da paisagem. O efeito completo descreve tanto o efeito na riqueza quanto o efeito na abundância relativa de espécies locais. Para isso, utilizamos como preditoras a métrica funcional de influência da paisagem na riqueza, e a capacidade de dispersão simulada para representar qualquer efeito da paisagem na abundância relativa não contemplado pelo efeito da métrica funcional. 
 
Para cada efeito causal médio da paisagem (área per se, fragmentação per se e fragmentação total), comparamos, via AICc (REF), 7 modelos hierarquicos aditivos generalizados (detalhes em Pedersen et al. 2019): i) com um tensor entre k e logU/U comum e com um tensor dessas duas variáveis por sítio de amostragem (com o tensor por sítio compartilhando o parâmetro de penalizado com o tensor comum); ii) com um tensor entre k e logU/U comum e apenas um intercepto por sítio; iii) 1 spline comum para logU/U e com um spline por sítio (compartilhando a penalização); iv) 1 spline para logU/U e com apenas 1 intercepto por sítio; v) 1 spline comum para k e por sítio (compartilhando a penalização); vi) 1 spline comum para k e apenas 1 intercepto por sítio; vii) 1 intercepto comum e por sítio. 

PRÓXIMO:
- ajustar os modelos só com k
- fazer a tabela de seleção
- modelo diagnóstico do mais plausível
- predição a posteriori
- logOR por sítio e médio

#####################################
############## ANTIGO  ##############
#####################################



Para os três efeitos causais da paisagem (área per se, fragmentação per se e fragmentação total), o modelos mais plausível é um modelo generalizado hierarquico aditivo que utiliza um parâmetro de penalização comum entre o spline fixo e os splines por sítio (Pedersen et al., 2019). E o segundo modelo mais plausível utiliza um parâmetro de penalização para cada spline por sítio (Pedersen et al., 2019). Em todos os modelos comparados existe boa evidência a favor da hipótese nula de ausência de autocorrelação espacial nos resíduos (o menor p-value from the Moran’s I statistics = 0.33, figura X tabelas).

__Área per se__

O modelo mais plausível, que explica cerca de 47% da deviance, supera o segundo modelo mais plausível por 91.62 AICc unidades. Esse modelo não apresenta boa performance em todo o gradiente da preditora (FIG. DIAG). Quando o log da razão da taxa U é próximo de zero pode existir grande variação no log odds ratio em alguns sítios, que não é possível ser descrito apenas em função do log da razão da taxa U (FIG. DIAG por sítio).[f] 

O efeito causal médio fixo descrito pelo modelo mais plausível apresenta padrão não linear, variando entre log odds ratio negativo e positivo ao longo dos valores do log da razão da taxa U (figura X). O efeito causal médio por sítio também apresenta padrão não linear, mas pode apresentar grande variabilidade entre sítios e em relação ao efeito fixo (figura X). Em valores negativos de log razão U, o efeito fixo apresenta uma tendência sútil para log odds ratio negativos; no nível dos sítios, há grande diversidade - existem sítios em que a tendência é de log odds ratio positivo, enquanto em outros é similar ao efeito fixo (FIGURA X). Para log razão U entre 0 e cerca de 0.30, o efeito fixo ocorre em valores positivos de log odds ratio aumentando e depois diminuindo. Nos sítios, alguns seguem o padrão fixo, mas com pico mais elevado, enquanto outros sítios apresentam tendência de queda para valores negativos de log odds ratio (FIGURA X). Para log razão U entre 0.30 e 0.50, o efeito fixo e por sítio apresentam tendência de queda. Nessa faixa, o efeito fixo varia entre 0 e -2.5 log odds ratio; os sítios que apresentavam log odds ratio positivo podem cruzar para valores negativos ou permanecerem próximos de zero. Poucos sítios apresentam log da razão U acima de 0.50, o efeito fixo volta a subir, retornando a valores positivos de log odds ratio quando o log razão U é próximo de 1. Nessa faixa a maioria dos sítios ocorre em log odds ratio negativo e a maioria apresenta tendência de aumento, mas nunca chegam a ter valores positivos de log odds ratio (Figura X). 
__Fragmentação per se__

O modelo mais plausível, que explica cerca de 60% da deviance, supera o segundo modelo mais plausível por 93.69 AICc unidades. Esse modelo não apresenta boa performance em todo o gradiente da preditora (FIG. DIAG). Quando o log da razão da taxa U é próximo de zero pode existir grande variação no log odds ratio em alguns sítios, que não é possível ser descrito apenas em função do log da razão da taxa U (FIG. DIAG por sítio).[g] 


