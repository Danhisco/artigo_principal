---
title: "Resultados Completos"
author: "Mori, Danilo"
date: "19/11/2022"
output: 
  bookdown::pdf_document2:
    latex_engine: xelatex
    fig_caption: yes
  bookdown::html_document2:
    toc: true
    toc_depth: 5
    fig_caption: yes
editor_options: 
  chunk_output_type: console
---

<style>
body {
text-align: justify}
</style>

```{r setup,include=FALSE}
knitr::opts_chunk$set(echo = FALSE,eval = TRUE,message = FALSE,warning = FALSE,cache=TRUE,
                      fig.align='center',tab.align='center')
# pacotes
library(grid)
library(gtable)
library(ggpubr)
# library(gt)
# library(dagitty)
# library(ggdag)
# library(gratia)
# library(sads)
library(doMC)
# library(metR)
library(kableExtra)
library(gridExtra)
library(ggplot2)
theme_set(theme_bw())
library(readr)
# library(purrr)
library(stringr)
library(tidyr)
# library(MuMIn)
# library(AICcmodavg)
# library(insight)
library(bbmle)
library(DHARMa)
# library(mgcv)
library(lme4)
library(data.table)
library(plyr)
library(dplyr)
source("source/general_tools.R")
source("source/GAMMtools.R")
# tamanho da fonte dos títulos dos gráficos dos resultados por síio de amosttragem (Umed e nCong)
v_titleS <- 1000
v_ncol_fatetwrap <- 14
figHeight=28
figWidth=40
textsize=1
#
f_z <- function(x) (x-mean(x))/sd(x)
##
# df p extensões
df_p_extensoes <- read_csv("dados/csv/df_p_extensoes.csv")
# df dados da proporção de cobertura vegetal
df_p <- read_csv("dados/df_p.csv")
# df dados para simulação
df_sim <- read_csv("dados/df_simulacao.csv") |> 
  inner_join(x=df_p,by="SiteCode")
# df_SoE
df_Usoe.rep <- read_csv("dados/csv/df_Usoe.csv") |> 
  pivot_longer(cols=`1`:`10`, names_to = "n", values_to = "U") |> 
  inner_join(x=distinct(select(df_sim,SiteCode,effort_ha:S_obs)),by="SiteCode") |> 
  arrange(S_obs,k)
# df_Urep
df_Urep <- list.files(path = "dados/csv/taxaU/MNEE", pattern = ".csv",recursive = T,full.names = T) %>%  
  adply(.,1,data.table::fread,.id=NULL) %>% na.omit()
# df_Unull
df_Unull <- df_Usoe.rep |> filter(round(lado_km) == 16)
## df_dados_disponiveis
df_dados_disponiveis <- read_csv(file = "dados/df_dados_disponiveis.csv")
## df_resultados 
df_resultados <- read_csv("dados/csv/resultados_MN/df_resultados.csv")
## df_sim
df_sim <- read_csv("dados/df_simulacao.csv")
## df_ad: dados completos, com todos os logOR e as proporções observadas para os 3 e as preditoras
df_ad <- df_resultados |>
  arrange(p) |> 
  inner_join(distinct(select(df_sim,SiteCode,Ntotal:S_obs)),"SiteCode") |> 
  mutate(diffS = (Smed - S_obs)/S_obs)
## df_contrastes: contrastes por sítio e grau de limitação de dispersão
df_contrastes <- read_csv(file="dados/csv/taxaU/df_contrastes.csv") |> 
  inner_join(df_sim |> select(SiteCode,Ntotal:S_obs) |> distinct(),
             by="SiteCode") |> 
  rename(N=Ntotal,S=S_obs) |> 
  mutate(across(N:S,log,.names="log.{.col}"),
         across(c(p,k,log.N:log.S),f_z,.names = "{.col}_z"),
         SiteCode = factor(SiteCode)) |> 
  select(-c(N:log.S))
# df_intePred_contrastes.csv
df_intPred <- read_csv("dados/csv/df_intePred_contrastes.csv")
## df_md: dados necessários para os modelos
df_md <- read_csv("dados/csv/df_md.csv")
## df_newdata
df_newpred <- read_csv(file="dados/csv/df_newpred.csv") |> 
  select(-starts_with("log_"))
## df_congContrastetsREP.cvs
df_congContrastes <- read_csv("dados/csv/resultados_MN/df_congContrastes.csv") |> 
  mutate(SiteCode = factor(SiteCode),
         contrasteSAD_z = ifelse(nCong==500,499.9,nCong),
         contrasteSAD_z = log((contrasteSAD_z/500)/(1-(contrasteSAD_z/500))),
         contrasteSAD_z = f_z(contrasteSAD_z)) |> 
  inner_join(df_contrastes |> 
               pivot_longer(cols=starts_with("efeito"),
                            names_to="pair",
                            values_to="contraste_z") |> 
               mutate(pair = case_when(pair == "efeito_frag"~"cont.non_frag",
                                       pair == "efeito_area"~"non_frag.ideal",
                                       pair == "efeito_conf"~"cont.ideal")) ) |> 
  relocate(contraste_z,.before = contrasteSAD_z)
df_plot <- fread("dados/csv/df_plot_geral.csv")
# themes
basic_theme <- function(data, ...){
  data %>% 
    tab_options(
      table.background.color = "white",
      ...
    )
}
```

```{r trackdown chunk, include=FALSE,eval=FALSE}
# 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
# pacotes
library(trackdown)
# both overwrite: 
# overwrite the current google drive file with the current Rmd:
# upload_file(file="secoes_texto/Resultados/Resultados.Rmd",
#             gpath="mestrado/artigo_principal/secoes_texto/",
#             hide_code=TRUE)
update_file(file ="secoes_texto/Resultados/Resultados.Rmd",
            gpath = "mestrado/artigo_principal/secoes_texto/",
            hide_code = TRUE)
# overwrite the current Rmd with the current google drive 
download_file(file = "secoes_texto/Resultados/Resultados.Rmd",
              gpath = "mestrado/artigo_principal/secoes_texto/")
```

# Inventários Florestais Selecionados

Dos sítios presentes na base de dados TreeCo, 109 estavam dentro dos critérios de seleção. As coordenadas dos sítios variaram entre -31° e -7° de latitude e entre -55° e -35° de longitude (fig. \@ref(fig:GE-sitios-amostrados) a). A maioria dos trabalhos foi realizada  em áreas de florestas classificadas como primárias no TreeCo. Apenas 2 sítios possuíam menos de 20 anos de recuperação desde o último grande distúrbio na área (fig. \@ref(fig:GE-sitios-amostrados) c) e foram removidos. A mediana da área amostrada foi de 1 ha; o número de indivíduos amostrados mediano foi de 1540 indivíduos; a riqueza observada mediana foi de 107 espécies; e o ano de amostragem ou publicação variou entre 1986 e 2016 (fig. \@ref(fig:GE-sitios-amostrados) b). Portanto, todos os 107 sítios restantes dentro dos critérios de seleção possuem paisagens contemporâneas na base de mapas de cobertura vegetal do mapbiomas 6. Não foi possível estimar a taxa U em um sítio com baixa densidade de espécies por número de indivíduos e de baixa proporção de cobertura vegetal na paisagem ao redor. Em outro sítio não foi possível desenhar a parcela quadrado no centro da paisagem devido a configuração espacial da paisagem. Esses dois sítios foram removidos, totalizando 105 sítios simulados.

```{r caption 1}
cap <- "Sítios selecionados na base de dados TreeCo. a) latitude e longitude das coordenadas centrais dos inventários florestais. b) boxplot de variáveis dos inventários: área da parcela, número de indivíduos amostrado, riqueza de espécies observado, e ano da amostragem ou da publicação. c) Classificação do estado de conservação ou sucessional da área amostrada no inventário: primary (floresta primária, não-alterada, primitiva, old-growth (≥80 anos de sucessão) ); primary/secondary (floresta em estágio avançado de sucessão (50 a 80 anos de sucessão)); secondary (floresta secundária, alterada, em estágio médio de regeneração (20 a 50 anos de sucessão)); capoeira (floresta em estado inicial de sucessão (<20 anos de sucessão))."
```
```{r GE-sitios-amostrados criacao,eval=FALSE,include=FALSE}
df_plot <- df_dados_disponiveis |> 
  select(SiteCode, effort_ha, Ntotal, S_obs, year_bestProxy, forest_succession, lat:long_correct)
l_p <- list()
l_p[[1]] <- df_plot |> 
  ggplot(aes(y=lat,x=long)) +
  geom_point(alpha=0.5) +
  theme_light() +
  labs(subtitle = "a)")
v_labels <- c("effort_ha" = "plot area (ha)",
              "Ntotal" = "# ind",
              "S_obs" = "riqueza",
              "year_bestProxy" = "approx. data year")
df_plot[grep("\\_",df_plot$year_bestProxy),"year_bestProxy"] <- "2012.5"
l_p[[2]] <- df_plot |>
  mutate(year_bestProxy = as.numeric(year_bestProxy)) |> 
  pivot_longer(effort_ha:year_bestProxy) |> 
  ggplot(aes(x=name,y=value)) +
  geom_jitter(alpha=0.4) +
  geom_boxplot() +
  labs(x="",y="",subtitle="b)") +
  facet_wrap(~name,ncol=1,scales="free", labeller = as_labeller(v_labels), strip.position = "bottom") +
  theme(axis.ticks.y = element_blank(),
        axis.text.y = element_blank(),
        strip.background = element_blank(),
        strip.placement = "outside") +
  coord_flip()
l_p[[3]] <- df_plot |> 
  ggplot(aes(x=forest_succession)) +
  geom_bar() +
  geom_text(aes(label = after_stat(count)), stat = "count", vjust = -0.2, colour = "black") +
  labs(x="classificação de estágio sucessional do TreeCo",
       y="countagem",subtitle="c)")
save(l_p,file="./dados/Rdata/figA21.Rdata")
```
```{r GE-sitios-amostrados,fig.width=12,fig.height=6,fig.cap=cap,cache=TRUE,fig.pos="H"}
load("./dados/Rdata/figA21.Rdata")
grid.arrange(grobs=l_p,nrow=1)
```

# Efeito de Escalar

```{r cap 2}
cap <- "a) Mudança na extensão espacial da paisagem a proporção de cobertura vegetal. Cada ponto representa a proporção de cobertura vegetal (eixo y) para aquela determinada extensão espacial da paisagem ao redor (eixo x), as linhas ligam pontos de um sítio de amostragem. b) Riqueza de espécies e densidade de indivíduos nas parcelas dos 106 sítios selecionados (parcela contígua de pelo menos 1ha). Em vermelho os pontos amostrados e selecionados para investigar a extensão espacial da paisagem ao redor usando MNEE (Scale of Effect, SoE). c) Cenários de limitação de dispersão simulados. k = proporção de propágulos que permanece até a vizinhança imediata (distância média entre indivíduos); d = desvio padrão da função de dispersão com distribuição de Laplace. Para detalhes sobre a seleção dos sítios na base TreeCo e sobre os cenários de limitação à dispersão olhar o texto principal."
```
```{r fig caption EE 1 e figura,fig.cap=cap,fig.pos="H"}
df_p2 <- df_sim |>
  filter(k==0.05) |> 
  mutate(sorteio_site = ifelse(SiteCode %in% unique(df_Unull$SiteCode),"SoE","non SoE"),
         DA = Ntotal / effort_ha)
l_p <- list()
l_p[[1]] <- df_p_extensoes |> filter(lado_km<=16.02) |> 
  ggplot(aes(x=lado_km,y=p)) + 
  geom_point(alpha=0.2,size=0.2) +
  geom_line(aes(group=SiteCode),linewidth=0.2,alpha=0.2) +
  labs(x="lado da paisagem quadrada (km)",y="proporção de cobertura vegetal",
       title="a) %CV ~ scale") +
  scale_y_continuous(breaks = seq(0,1,by=0.1)) +
  coord_cartesian(expand = F) +
  theme_light()
l_p[[2]] <- df_p2 |> 
  ggplot(aes(x=DA,y=S_obs,color=sorteio_site)) +
  geom_point(alpha=0.8) +
  scale_color_manual(values=c("black","red"),name="SoE: 36 sites") +
  labs(x="density (individuals / ha)", 
       y="spp richness",
       title="b) 36 sítios no estudo da escala") +
  theme(legend.position = "bottom")
l_p[[3]] <- df_sim |> 
  ggplot(aes(x=k,y=d,group=k)) +
  geom_jitter() +
  geom_boxplot() +
  labs(x = "k",
       y = "d",
       title = "c) 20 graus de dispersão")
# grid.arrange(grobs=l_p,nrow=1)
save(l_p,file="./apendices/EfeitoEscala/Rdata/fig1_grobs.Rdata")
```
```{r EE-setup,fig.height=3.5,fig.width=10,fig.cap=cap}
load(file="./apendices/EfeitoEscala/Rdata/fig1_grobs.Rdata")
grid.arrange(grobs=l_p,nrow=1)
```

A extensão espacial é um dos fatores que determina a quantidade de habitat remanescente na paisagem. No conjunto de áreas analisadas há uma forte relação entre a extensão espacial da paisagem ao redor e a proporção de cobertura vegetal (fig. \@ref(fig:EE-setup) a). O objetivo do estudo do efeito de escalar é determinar a extensão espacial adequada para simular os 20 graus de limitação de dispersão (fig. \@ref(fig:EE-setup) c). Escala adequada de um grau de limitação de dispersão foi definida como a extensão espacial que acumula a maior parte da variação na estimativa da taxa U associada ao aumentar a extensão espacial da paisagem ao redor, considerando a amplitude de extensões do lado da paisagem local entre 0.5 km e 16 km. Para detalhes sobre os métodos  do estudo de efeito de escalar veja o apêndice ‘Efeito de Escalar’. Nesse  estudo, 36 sítios foram sorteados e selecionados ao longo do gradiente de número de indivíduos e de espécies na parcela (fig. \@ref(fig:EE-setup) b). Para esse estudo, as estimativas da taxa U foram simuladas em paisagens totalmente preenchidas com habitat, para descontar o efeito do isolamento estrutural, e explorar apenas o efeito de variar a extensão da paisagem ao redor. 
A taxa U estimada nos graus de limitação de dispersão simulados nas paisagens com maior extensão espacial (paisagem quadrada de lado 16 km) é qualitativamente similar ao estimado em paisagens infinitas (figura A1 2). Em paisagens infinitas e sem perda de habitat a taxa U necessária para manter uma determinada riqueza na parcela apresenta um máximo global quando o grau de limitação de dispersão é pouco severa (@May2012). Em graus de limitação à dispersão severa a taxa U estimada é baixa, pois a perda de espécies é pequena: a maior parte das substituições ocorre entre coespecíficos. Com o relaxamento da limitação de dispersão a perda de espécies aumenta com a redução da substituição de coespecíficos, aumentando a perda de espécies por deriva ecológica. Com o aumento da capacidade de dispersão para além de graus severos, há o aumento da contribuição de subpopulações da paisagem mais distante da parcela, reduzindo novamente a estimativa da taxa U. Portanto, concluímos que foi adequado utilizar a maior extensão espacial (de lado 16km) como referência de extensão espacial suficiente para simular todos os graus de limitação de dispersão.

Analisamos os dados agrupados por sítio de amostragem (Fig A1 2a e 2b). A estimativa da taxa U em função do grau de limitação de dispersão apresenta padrão não linear (Fig A1 2a e 2b). Em graus de limitação de dispersão severos a média da taxa U se mantém baixa e com pouca variação entre graus de limitação de dispersão severos, formando um primeiro patamar de valores baixos (Fig A1 2a e 2b). Com o relaxamento para graus pouco severos, há um salto na média da taxa U, que pode se manter por alguns graus de limitação de dispersão pouco severos (Fig A1 2a e 2b). Com o maior relaxamento da limitação de dispersão para graus brandos, há a redução gradual da média da taxa U até valores médios similares ao observado em graus severos de limitação de dispersão (Fig A1 2a e 2b). O tamanho dos patamares e a forma com que a redução na taxa U ocorre parece depender de uma relação não trivial entre número de indivíduos, número de espécies e grau de limitação de dispersão (figura A1 2b).

Para descrever a variação na taxa U associada à variação na extensão espacial para um determinado grau de limitação de dispersão, exploramos um modelo gaussiano em que a taxa U média pode ser descrita em função do número de espécies e indivíduos (na escala log) e do grau de limitação de dispersão e da extensão espacial (como variáveis categóricas) com um intercepto aleatório por sítio de amostragem (detalhes no apêndice ‘Efeito de Escalar’). Avaliamos, por grau de limitação de dispersão, como a média variou em função do aumento da extensão espacial da paisagem. A escala que acumulou a maior parte da variação total (de aumentar o lado da paisagem local de 0.5 km até 16 km) foi considerada como escala adequada para aquele grau de limitação de dispersão. Essa abordagem pressupõe que o efeito de escalar sempre ou aumenta ou reduz a taxa U média para um grau de limitação de dispersão. 

Observamos que, exceto em graus de limitação de dispersão pouco severos onde há o máximo global na estimativa da taxa U em paisagens com maior extensão espacial (lado de 16 km) e sem perda de habitat (Fig A1 2a e 2b), a extensão espacial adequada tende a aumentar com a redução da limitação de dispersão (Figura 3). Nos graus de limitação de dispersão em que isso não foi observado há pouca variação na média da taxa U entre escalas e sempre grande variação entre réplicas de uma mesma bateria de simulações (Fig A1 2a, A1 2b e A1 4b). Quando a proporção de propágulos que permanece até a vizinhança imediata do progenitor (k) varia entre 0.99 e 0.90, a extensão espacial da paisagem adequada é de 1 km de lado (Figura 3). Para k entre 0.80 e 0.55, que corresponde ao campo de parâmetros com máximo global, não é possível determinar uma tendência de redução da média da estimativa de U (Figura 3); a variação entre escalas para um mesmo sítio é baixa (Figuras A1 2 e A1 3). Em k entre 0.50 e 0.35 a extensão adequada foi de 1 km de lado; entre 0.30 e 0.20, 2 km de lado; e entre 0.15 e 0.05, 4 km de lado (Figura A1 5 e 6). Pressuposto que a extensão espacial adequada para simular k entre 0.80 e 0.55 pode ser obtida interpolando as escalas adequadas, então nesses graus de limitação de dispersão a extensão suficiente é a de 1 km de lado da paisagem ao redor.

```{r caption EfeitoEscalar-obs}
cap <- "U estimado (eixo y) nas diferentes extensões espaciais (eixo x) e para os 20 graus de limitação de dispersão (cor dos pontos e linhas). Pontos representam a média de 10 réplicas por bateria de simulação e as linhas ligam os pontos médos. Eixo y varia entre paineis."
```
```{r EfeitoEscalar-obs, fig.width=14,fig.height=8.5,fig.cap=cap,fig.pos="H"}
load(file="./apendices/EfeitoEscala/Rdata/fig3_EfeitoEscalarObs.Rdata")
p + theme(plot.title = element_text(size = 12)) 
```

```{r cap-resumo-EscalaAdequada,cache=FALSE}
cap <- "Lado da paisagem que acumula a maior parte do efeito da escala no grau de limitação de dispersão. Em cinza a área com incerteza: os lados de 1 e 2 km podem ser adequados."
df_plot <- read.csv("dados/csv/df_plotSoE.csv")
p <- df_plot |>
  ggplot(aes(x=k_factor,y=SoE_0.95)) +
  geom_hline(yintercept = 4,color="red") +
  geom_point() +
  # geom_rect(aes(xmin=4, xmax=13.5, ymin=0.99, ymax=2.1),alpha=0.01) +
  scale_y_continuous(trans = scales::log2_trans(), 
                     limits = c(1, 16),
                     breaks = 2^(0:4)) +
  scale_x_reverse() +
  labs(x="k",
       y="lado da paisagem (km)",
       title="A escala de 4x4 km2 é adequada\n para todos os graus de dispersão") +
  theme_bw() + 
  theme(plot.title = element_text(size = 3)) 
save(p,file="./apendices/EfeitoEscala/Rdata/fig6_resumo_EscalaAdequada_k.Rdata")
```
```{r resumo-EscalaAdequada-k,fig.height=2.5,fig.width=3,fig.cap=cap,fig.pos="H"}
load(file="./apendices/EfeitoEscala/Rdata/fig6_resumo_EscalaAdequada_k.Rdata")
p
```



# taxa U



A partir dessa seção iremos analisar os dados das simulações feitas nos 3 tipos de paisagens hipotéticas: a paisagem contemporâneas, com a configuração espacial do habitat remanescente observada no mesmo ano que a melhor aproximação do ano da amostragem da parcela; a paisagem sem fragmentação per se, onde todo o habitat remanescente na paisagem contemporânea é aglomerado ao redor  da parcela em forma de quadrado; e a paisagem idealizada, sem perda de habitat. Quando há pouca perda de habitat a estimativa da taxa U não difere entre as 3 paisagens hipotéticas (fig. \@ref(fig:GE-Urep-sitio-k-land)). Para paisagens contemporâneas com proporção de cobertura vegetal abaixo de 0.95, observamos que a estimativa da taxa U pode ser distinta entre paisagens hipotéticas para alguns graus de limitação de dispersão (fig. \@ref(fig:GE-Urep-sitio-k-land)). A maior variação entre graus de limitação de dispersão ocorre nos graus de limitação de dispersão mais brandos simulados, seguido pelos graus mais severos; nos graus de limitação de dispersão pouco severos, onde há o máximo global nas paisagens infinitas e sem perda de habitat (olhar seção ‘Efeito de Escalar’), ocorre a menor variabilidade entre tipos de paisagens hipotéticas (fig. \@ref(fig:GE-Urep-sitio-k-land)). Em geral a paisagem hipotética contemporânea apresenta maior divergência com as outras duas paisagens hipotéticas, sem fragmentação per se e idealizada (fig. \@ref(fig:GE-Urep-sitio-k-land)). Em alguns casos, a paisagem sem fragmentação per se pode apresentar maior diferença com o simulado na paisagem idealizada, e pode apresentar estimativas superiores de U em relação às outras 2 paisagens hipotéticas (fig. \@ref(fig:GE-Urep-sitio-k-land)). Em resumo: i) quanto maior a perda de habitat e mais branda a limitação de dispersão, maior a potencial diferença entre as 3 paisagens hipotéticas; ii) em geral a taxa U estimada em paisagens contemporâneas é superior ao estimado nos outros 2 tipos de paisagens hipotéticas; porém, para alguns sítios, o estimado em  paisagem sem fragmentação per se pode ser superior. 

```{r caption GE  características dos Sítios Selecionados}
# caption
cap <- "Taxa U estimada em cada sítio nos 20 graus de limitação de dispersão simulados e coloridos pelo tipo de paisagem hipotética. Os sítios estão organizados pela proporção de cobertura vegetal na paisagem de 4x4 km2 (p). Nos rótulos dos paineis há o código do sítio de amostragem, a proporção de cobertura vegetal (p), e a classe do estágio sucessional da área amostrada segundo o TreeCo"
```
```{r figura GE características dos Sítios Selecionados, eval=FALSE,include=FALSE,fig.cap=cap}
# figura
df_plot <- df_Urep %>% select(-d) %>% 
  pivot_longer(-c(SiteCode:k),names_to = "rep",values_to = "U") |>
  inner_join(df_p) |> 
  arrange(p) |> 
  mutate(label = paste0(SiteCode,", p=",round(p,2)))
df_plot$label <- factor(df_plot$label,levels=unique(df_plot$label))
p <- df_plot |> 
  ggplot(aes(x=k,y=U,color=land_type)) +
  geom_point(alpha=0.1) +
  # geom_line() +
  stat_summary(geom = "line",fun.data = mean_se,alpha=0.5) +
  scale_x_reverse() +
  scale_y_continuous(labels = function(x) format(x, scientific = TRUE)) +
  theme_bw() +
  labs(color="landscape type") +
  theme(legend.position = "top",
        axis.text=element_text(size=4.5),
        strip.text = element_text(size = 4.5, margin = margin())) +
        # legend.title=element_text(size=v_titleS),
        # legend.text = element_text(size = v_titleS)) +
  scale_color_manual(values=c("darkred","darkblue","darkgreen"),
                     labels=c("contemporâneo","idealizado","sem fragmentação")) +
  facet_wrap(~label,ncol=v_ncol_fatetwrap,scales="free")
save(p,file="./dados/Rdata/figA23.Rdata")
```
```{r GE-Urep-sitio-k-land,eval=TRUE,fig.height=figHeight,fig.width=figWidth,fig.cap=cap,fig.pos="H"}
load("./dados/Rdata/figA23.Rdata")
p
```

__\@ref(fig:GE-Urep-sitio-k-land)__  (\@ref(fig:GE-sitios-amostrados))

\newpage








# SAD observada e SAD predita entre paisagens hipotéticas

## Descrição do padrão observado[a]

Na figura \@ref(fig:GE-nCong) há os gráficos de congruência da SAD simulada e observada (número de SADs simuladas congruentes com a SAD observada) em cada sítio de amostragem. No eixo x há o grau de limitação de dispersão per capita (k, proporção de propágulos que permanece até a vizinhança imediata da progenitora). O fundo dos painéis está colorido pela proporção de cobertura vegetal (p). Os painéis estão agrupados pela classe de estado sucessional da base de dados TreeCo. No canto inferior direito a distribuição de sítios em função de p e da classe de sucessão[b]. É possível observar, em alguns graus de limitação de dispersão, diferença no predito entre paisagens hipotéticas em paisagens com cobertura vegetal abaixo de 0.92 e pode aumentar com a redução da cobertura vegeta[c]l (fig.  \@ref(fig:GE-nCong)).  O predito em paisagens idealizadas e sem fragmentação apresenta menor divergência.  Em geral, o predito em paisagens contemporâneas pode apresentar congruência melhor ou pior, em relação às outras duas paisagens hipotéticas, em graus de limitação de dispersão mais brandos[d]. Existe muita diversidade entre sítios, mas podemos classificar os padrões de congruência com o observado em tipos: sempre [e]bom ou ruim; ruim ou bom em graus de limitação de dispersão brandos; ruim ou bom em graus de limitação de dispersão intermediários. Ou seja, observamos variabilidade[f] em todo o gradiente de limitação de dispersão simulada, com maior variabilidade em graus brandos de limitação de dispersão, seguido de graus severos, e menor variabilidade em graus de limitação intermediários. A classe sucessional do sítio de amostragem parece aumentar a variabilidade no padrão de congruência: em sítios primary e secondar[g]y, paisagens contemporâneas parecem ser tão boas quanto ruins[h]; em sítios secondary, paisagens idealizadas tendem a ser melhores. [i]
  

Especulamos que parte da diversidade observada[j] pode estar relacionada com a distribuição espacial dos sítios. As paisagens contemporâneas sugerem que algumas parcelas  foram amostradas em paisagens locais com alto grau de sobreposição espaço-temporal (Fig. SI 1). [k]
Além disso, possíveis determinantes da diversidade local observada na Floresta Atlântica podem estar associados às variáveis preditoras empíricas (p e classe de sucessão) por conta da sua localidade (e.g. fig SI 2). [...[l]][m]
Na figura \@ref(fig:GE-coordenadas-preditoras) há os resultados dessa classificação visual [n]dos painéis da figura \@ref(fig:GE-nCong) e as preditoras empíricas[o], proporção de cobertura vegetal (p) e classe de sucessão do local de amostragem,  em função das coordenadas geográficas dos sítios de amostragem. As preditoras empíricas, proporção de cobertura vegetal (p) e classe de sucessão, parecem apresentar distribuição espacial não negligenciável[p] (figura \@ref(fig:GE-nCong) c:d), com agregação de paisagens com alta proporção de cobertura vegetal na região costeira[q]. 
Para realizar uma avaliação preliminar da possível influência do espaço nos padrões de congruência observados (figura \@ref(fig:GE-nCong)), fiz uma classificação visual dos sítios em dois eixos: similaridade e diferença entre os tipos de paisagens hipotéticas e congruência do modelo neutro[r] (considerando simultaneamente os 3 tipos de paisagens). Os sítios em que a paisagem contemporânea apresenta melhor ou pior congruência parecem apresentar autocorrelação positiva[s], porém as outras características da congruência com o observado são de difícil avaliação visual. 

Outro ponto importante que não avaliamos é a influência da complexidade espacial da cobertura espacial na paisagem local. Em paisagens contemporâneas em que todo o habitat remanescente está empiricamente aglomerado podemos não observar diferença entre as paisagens, principalmente entre os tipos de paisagens hipotéticas contemporâneos e sem fragmentação. Nesse contexto, eu havia desenvolvido uma métrica de fragmentação per se baseado no contraste da taxa U no simulado entre paisagens contemporâneas e sem fragmentação per se.[t]  A taxa U pode ser usada para desenvolver uma métrica de conectividade que depende tanto da capacidade de dispersão quanto da particular configuração espacial do habitat. Eu defini que o efeito de fragmentação per se é a diferença entre a taxa U estimada na paisagem contemporânea, menos a estimada na paisagem sem fragmentação per se, o resultado dividido pelo estimado na paisagem idealizada. Apliquei essa lógica para todos os 3 possíveis contrastes par a par das 3 paisagens hipotéticas. Na figura SI 3 há o predito para o contraste entre cada possível par de paisagens hipotéticas, na figura \@ref(fig:GE-Urep-sitio-k-land) há as taxas U estimadas. [u]



```{r ggplot2code GE nCong,eval=TRUE,include=FALSE,cache=TRUE}
df_plot <- df_md |> select(SiteCode:nCong,p_z:k_z) |> 
  inner_join(df_p) |> 
  inner_join(df_dados_disponiveis |> 
               filter(forest_succession != "capoeira") %>% 
               select(SiteCode, forest_succession)) %>% 
  arrange(p) |> 
  mutate(label = paste0(SiteCode,", p=",round(p,2)))
df_plot$label <- factor(df_plot$label,levels=unique(df_plot$label))
#
f_plot <- \(nvresp="nCong",
            png_repo = "apendices/analise_dados/figuras/",
            end_name = "_k_land.hyp_site"){
  f_ <- \(dfi){
    dfi %>% 
      ggplot(aes(x=k,y=.data[[nvresp]],color=land_hyp,fill = p)) +
      geom_rect(aes(xmin = -Inf, xmax = Inf, ymin = -Inf, ymax = Inf)) +
      geom_point(alpha=0.5) +
      geom_line(alpha=0.5) +
      scale_x_reverse() +
      theme_bw() +
      labs(color="landscape hyp.") +
      theme(legend.position = "top",
            axis.text=element_text(size=4.5),
            axis.title = element_text(size = 20),
            strip.text = element_text(size = textsize, margin = margin())) +
            # legend.title=element_text(size=v_titleS),
            # legend.text = element_text(size = v_titleS)) +
      scale_color_manual(values=c("darkred","darkblue","darkgreen"),
                         labels=c("contemporâneo","idealizado","sem fragmentação")) +
      scale_fill_gradientn(colours = terrain.colors(10),trans="reverse",values = c(0,0.5,1),guide = "none") +
      # scale_fill_gradient2(low="white",mid = "brown",high="green",midpoint = 0.5,limi)
      facet_wrap(~label,ncol=5)
  }
  l_p <- dlply(df_plot,"forest_succession",f_)
  l_p <- alply(names(l_p),1,\(nli){
    l_p[[nli]] + labs(title = nli) + theme(plot.title = element_text(hjust = 0.5))
  })
  save(l_p,file=paste0("./dados/Rdata/",nvresp,end_name,".Rdata"))
}
f_plot()
########
nvresp="nCong";png_repo = "apendices/analise_dados/figuras/";end_name = "_k_land.hyp_site"
oname <- load(file=paste0("./dados/Rdata/",nvresp,end_name,".Rdata"))
l_p <- get(oname)
laymat <- cbind(rep(1,10),
                c(rep(2,6),NA,NA,NA,NA),
                c(rep(3,6),NA,NA,NA,NA))
legend_position="top"
plot_table <- ggplot_gtable(ggplot_build(l_p[[1]])) # get tabular interpretation of plot 
index_legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box") #  Mark only legend in plot 
common_legend <- plot_table$grobs[[index_legend_plot]] # extract legend 
# títulos associados
l_title <- llply(l_p,\(li){
  p_title <- ggplot_gtable(ggplot_build(li))  
  index_title <- str_which(sapply(p_title$grobs, function(x) x$name),"plot.title")
  p_title$grobs[[index_title]] 
})
# remoção dos títulos e das legendas
l_p <- llply(l_p,\(li){
  # arrumar título
  p_title <- ggplot_gtable(ggplot_build(li))  
  index_title <- str_which(sapply(p_title$grobs, function(x) x$name),"plot.title")
  p_title <- p_title$grobs[[index_title]] 
  # remoção de legenda e ajuste eixos
  li +  
    theme(legend.position = "none",
          plot.title = element_blank(),
          axis.title = element_text(size = textsize)) +
    labs(y="#SADs cong")
  # # arranjo dos gráficos
  })
arrenged_plot <- arrangeGrob(grobs=l_p,layout_matrix = laymat)
arrenged_plot <- arrangeGrob(arrangeGrob(grobs = l_title,nrow = 1),
                             arrenged_plot,
                             heights = c(0.5, 10))
if(legend_position=="bottom"){
  p <- arrangeGrob(common_legend,arrenged_plot,ncol=1,heights = c(10, 1))
}else if(legend_position=="top"){
  p <- arrangeGrob(common_legend,arrenged_plot,ncol=1,heights = c(1, 10))
}
l_plot <- list()
l_plot[[1]] <- p %>% as_ggplot()
l_plot[[2]] <- df_plot %>% filter(k==0.05,land_hyp=="cont") %>% distinct() %>%
  ggplot(aes(x=forest_succession,y=p,colour=p)) +
  geom_boxplot() +
  geom_jitter(size=2) +
  theme_grey() +
  scale_colour_gradientn(colours = terrain.colors(10),trans="reverse",values = c(0,0.5,1),
                         guide=guide_colourbar(reverse = TRUE,barheight = 15)) +
  scale_x_discrete(labels=c("secondary" = "2a", "primary" = "1a", "primary/secondary"="1a/2a")) +
  theme(legend.position = "left",
        # axis.text.y=element_blank(),
        # axis.ticks.y=element_blank(),
        # axis.title.y = element_blank(),
        axis.title.x = element_blank()) +
  labs(x="forest succession")
save(l_plot,file="./figuras/fig6_final.Rdata")
#
v_size = 3
# v_w <- 860
png("./figuras/fig6_final.png",width = 743 * v_size, height = 712 * v_size,res = 72 * v_size)
l_plot[[1]]
print(l_plot[[2]],vp=viewport(0.85, 0, 0.3, 0.3,just = "bottom"))
dev.off()
```
```{r caption GE nCong }
cap <- "Número de SADs simuladas congruentes com a SAD empírica (eixo y). A classificação da SAD simulada como congruente ocorreu quando a comparação entre SADs segundo um teste de Kolmogorov-Smirnov apresentou p-valor igual ou maior do que 0.05. No eixo x há o grau de limitação de dispersão per capita (k). Os pontos são coloridos pelo tipo de paisagem hipotética pressuposta pela simulação. Os paíneis estão organizados pela proporção de cobertura vegetal na paisagem ao redor de 4x4km2."
```
```{r GE-nCong,eval=TRUE,fig.height=10,fig.width=figWidth,fig.cap=cap,fig.pos="H",cache=FALSE}
p <- ll_ggpng("./figuras/fig6_final.png")[[1]]
p
# load("./figuras/fig6_final.Rdata")
# l_plot[[1]]
# print(l_plot[[2]],vp=viewport(0.70, 0, 0.3, 0.3,just = "bottom"))
```

\newpage

```{r caption next figure}
cap <- "Distribuição espacial da avaliação visual e das preditoras empíricas. Na primeira linha (a e b) as classificações visuais do padrão de congruência com o observado: a) diferença entre as paisagens hipotéticas; b) congruência do predito pelo modelo neutro (independente do tipo de paisagem) com a SAD observada ao longo dos graus de dispersão simulados. Na segunda linha (c e d) as preditoras empíricas: c) proporção de cobertura vegetal (p); e d) classe de sucessão ecológica do TreeCo (primary =>80 anos desde o dist., primary/secondary = entre 80 e 50 anos, secondary = entre 50 e 20 anos)"
```
```{r GE-coordenadas-preditoras,fig.cap=cap,fig.height=10,fig.width=10}
# Install and load necessary packages
# library(sf)
# dados
df_class <- read.csv(file="./dados/csv/df_class.csv")
# df_class$land_diff %>% table()
v_landdiff <- df_class$land_diff %>% unique()
# df_class$Cong %>% table()
v_cong <- df_class$Cong %>% unique()
df_class <- df_class %>% mutate(
  classi_land = case_when(land_diff %in% c("similar","igual") ~ "similares",
                          land_diff %in% v_landdiff[str_which(v_landdiff,"contemp")] ~ "contemp. dif.", 
                          land_diff %in% v_landdiff[str_which(v_landdiff,"ideal")] ~ "ideal.\ndif.",
                          land_diff == "sem frag pior" ~ "sem frag.\ndif."),
  classi_land2 = case_when(land_diff %in% v_landdiff[str_which(v_landdiff,"contemp")] ~ gsub("contemp ","cont. \n",land_diff),
                           TRUE ~ classi_land),
  classi_cong = case_when(Cong %in% c("ruim exceto em graus brandos","melhor em graus brandos") ~ "boa em brandos",
                          Cong == "ruim em intermediário e boa em graus brandos" ~ "ruim em intermed",
                          TRUE ~ Cong)) %>% 
  select(-land_diff,-Cong)
df_class$classi_cong <- gsub(" graus","",df_class$classi_cong) %>% 
  gsub("intermediários","intermed",.) %>% 
  gsub(" em"," em\n",.)
#
df_plot <- df_md |> select(SiteCode:nCong,p_z:k_z) |> 
  inner_join(df_p) |> 
  inner_join(df_dados_disponiveis |> 
               filter(forest_succession != "capoeira") %>% 
               select(SiteCode, forest_succession)) %>% 
  arrange(p) |> 
  mutate(succession = case_when(forest_succession == "primary" ~ "1°",
                                forest_succession == "secondary" ~ "2°",
                                forest_succession == "primary/secondary" ~ "1.5°"),
         label = paste0(SiteCode,", p=",round(p,2)," ,suc=",succession)) %>% 
  select(-succession)
df_plot$label <- factor(df_plot$label,levels=unique(df_plot$label))
df_plot <- inner_join(df_plot,df_class) %>% 
  inner_join(.,df_dados_disponiveis %>% select(SiteCode, lat:long_correct))
#
v_labels <- c("classi_land2"="a) Diferença entre paisagens","classi_cong"="b) Congruência do modelo neutro",
              "p"="c) % cobertura vegetal (p)","forest_succession"="d) classe de tempo desde o último dist. no local")
l_vcolors <- list()
# l_vcolors[[1]] <- c("similares"="black","sem frag. dif."="#003300","contemp. dif."="#CC0000","ideal. dif."="darkblue")
l_vcolors[[1]] <- c("similares"="black","sem frag.\ndif."="#003300","ideal.\ndif."="darkblue",
                    "cont. \nmelhor"="darkred","cont. \npior"="#E69F00","cont. \ndiferente"="darkgrey")
l_vcolors[[2]] <- c("boa"="#003300","boa exceto em\n brandos"="yellow","boa em\n intermed"="darkblue","boa em\n brandos"="purple","ruim em\n intermed"="#CC0000","ruim"="#FF0000")
l_vcolors[[3]] <- NA
l_vcolors[[4]] <- c("secondary"="darkblue","primary/secondary"="darkred","primary"="darkgreen")
names(l_vcolors) <- names(v_labels)
#
f_plot <- \(cname){
  v_colors <- l_vcolors[[cname]]
  p <- df_plot |> 
  mutate(lat=ifelse(is.na(lat),lat_correct,lat),
         long=ifelse(is.na(long),long_correct,long)) %>% 
  filter(k==0.05,land_hyp=="cont") %>% 
  ggplot(aes(y=lat,x=long,color=.data[[cname]])) +
    geom_point(shape=15,size=5,alpha=0.8) + # alpha=0.5
    {if(cname=="p") scale_colour_gradientn(colours = terrain.colors(10),
                                           trans="reverse") else scale_color_manual(values=v_colors)} +
    theme_light() +
    theme(legend.position = c(.95, .35),
          legend.title = element_blank(),
          # aspect.ratio = 1,
          legend.justification = c("right", "top"),
          legend.box.just = "right",
          legend.margin = margin(0, 0, 0, 0)
          # legend.background = element_blank(),
          # legend.box.background = element_rect(colour = "black")
          ) +
    # guides(color = guide_legend(override.aes = list(size = 1))) +
    labs(subtitle = v_labels[cname])
  p_return <- if(cname!="p"){
    p + theme(legend.background = element_blank(),legend.box.background = element_rect(colour = "black"))
  }else{
    p
  }
  return(p_return)
}
l_p <- alply(names(v_labels),1,f_plot)
grid.arrange(grobs=l_p,ncol=2)
# save(p,file="./dados/Rdata/coordenadas_preditoras.Rdata")
```
```{r GE-coordenadas-preditoras0,fig.cap=cap,eval=FALSE}
# load(file="./dados/Rdata/coordenadas_preditoras.Rdata")
# p
```

```{r tabela com o nome das predioras,eval=FALSE,include=FALSE}
df_glossario <- data.frame(
  nome = c("k","p","forest succession","land hyp","SiteCode"),
  `descrição` = c("grau de limitação de dispersão per capita",
                  "proporção de cobertura vegetal na extensão de 4x4 km2",
                  "classe de sucessão ecológica",
                  "classe da paisagem simulada",
                  "código do sítio de amostragem"))
f_kableExtra(df_glossario,string_caption = "Descrição das variáveis preditoras",col_control=FALSE)
```

```{r caption-ts-re-ncong,eval=FALSE,include=FALSE}
cap <- "Seleção da Estrutura Aleatória"
snote <- "estrutura fixa do modelo cheio usada em ambos modelos"
```

```{r ts-re-ncong,eval=FALSE,include=FALSE}
df_ts_re <- read.csv("./dados/csv/df_ts_re_nCong.csv")
f_kableExtra(df_ts_re,string_caption = cap,footnote = snote,col_control = FALSE)
```

```{r c1,eval=FALSE,include=FALSE}
cap <- "Seleção da Estrutura Fixa"
snote <- "estrutura aleatória mais plausível usada em todos os modelos"
```

```{r ts-ncong,eval=FALSE,include=FALSE}
df_ts <- read.csv("./dados/csv/df_ts_defesa_congruencias.csv")
f_kableExtra(df_ts,string_caption = cap,footnote = snote,col_control = FALSE)
```

```{r c2,eval=FALSE,include=FALSE}
cap <- "Predito pelo modelo mais plausível para descrever a congruência entre SAD empírica e simulada"
```

```{r nCong-md-predito,fig.height=8,fig.width=8,fig.cap=cap,fig.pos="H",eval=FALSE,include=FALSE}
oname <- load(file="./dados/Rdata/glmm_nCong_selecionado.Rdata")
l_md_e_start <- get(oname)
df_newdata <- l_md_e_start$modelo@frame[,-1]
df_newdata <- with(df_newdata,{
  expand.grid(SiteCode = "SPigua1",
              forest_succession = unique(forest_succession),
              k_z = seq(min(k_z),max(k_z),length.out=150),
              land_hyp = unique(land_hyp),
              p_z = seq(min(p_z),max(p_z),length.out=150))
})
# gráficos
df_newdata$pred <- predict(l_md_e_start$modelo,newdata=df_newdata, re.form=~0)
v_range <- range(df_newdata$pred)
# v_breaks1 <- c(-0.2,0,0.2,0.5,1)
df_newdata %>%
  mutate(land_hyp = factor(land_hyp,
                           levels=c("cont","non_frag","ideal"),
                           labels=c("contemp.","sem frag.","ideal."))) %>% 
  ggplot(aes(x=p_z,y=k_z,fill=pred,z=pred)) +
  geom_raster() +
  geomtextpath::geom_textcontour(aes(z=pred),color="blue",straight = TRUE) +
  scale_fill_gradient2(low="green",
                       mid="red",
                       high="black",
                       midpoint = 2,
                       limits=v_range) +
  scale_y_reverse() +
  theme_classic() +
  guides(fill = guide_colourbar(title = "logito")) +
  coord_cartesian(expand = FALSE) +
  labs(x="z(p)",y="z(k)") +
  theme(legend.position = "top") +
  facet_grid(land_hyp~forest_succession)
```

```{r exemplo tabela,eval=FALSE,include=FALSE}
df_tab <- read_csv("./dados/csv/ts_congCont.csv")
df_tab |> 
  gt(groupname_col = "pair",
     # rowname_col = "modelo",
     rownames_to_stub = F) |> 
  # tab_header(title = "GAMM usados para descrever a congruência na SAD entre contrastes") |> 
  fmt_number(columns = dAICc:dev.expl,decimals = 2, suffixing = TRUE) |> 
  cols_label(dev.expl = "dev. expl.") |> 
  tab_row_group(label = md("<center><b>Sem Fragmentação <i>per se</i> : Idealizado<b/></center>"),
                rows = 5:6) |> 
  tab_row_group(label = md("<center><b>Contemporâneo : Sem Fragmentação <i>per se</i><b/></center>"),
                rows = 3:4) |>
  tab_row_group(label = md("<center><b>Contemporâneo : Idealizado</center></b>"),
                rows = 1:2) |>
  tab_style(style = cell_fill(color = "gray75"),
            locations = cells_row_groups(groups = 1:3)) |> 
  cols_align(align = "right") |> 
  tab_style(style = cell_text(align = "left",
                              weight = "bold"),
            locations = cells_column_labels(columns = modelo:dev.expl)) |> 
  text_case_when(x == "f(contraste_z)" ~ "~ f(contraste U)",
                 x == "f(k_z,p_z)" ~ "~ f(k, p)",
                 .default = "",.locations = cells_body(columns = "modelo")) |> 
  cols_width(modelo ~ px(130),where(is.numeric) ~ px(100))
```

```{r ip contrastes ~ p k,fig.height=figHeight,fig.width=figWidth,eval=FALSE,include=FALSE}
df_plot <- df_intPred |> 
  mutate(p = p_z*sd(df_ad$p) + mean(df_ad$p),
         k = k_z*sd(df_ad$k) + mean(df_ad$k),
         name=factor(name,levels=paste0("efeito_",c("area","frag","conf")))) |> 
  select(-contains("_z"),-predito) |> 
  pivot_longer(starts_with("Q_0."),values_to = "pred",names_to = "label")
df_plot$label <- factor(df_plot$label,levels = unique(df_plot$label)[c(3,2,4,1,5)])
# gráficos
v_range <- range(df_plot$pred)
v_breaks1 <- c(-0.2,0,0.2,0.5,1)
f_plot <- function(df){
  f_ggplot <- function(df,facets=2){
  ggplot(df,aes(x=p,y=k,z=pred,fill=pred)) +
    geom_raster() +
    geom_contour(aes(z=pred),
                 size=0.5,color="darkblue",
                 breaks=v_breaks1) +
    geom_text_contour(aes(z=pred),
                      breaks=v_breaks1,
                      label.placer = label_placer_flattest()) +
    scale_fill_gradient2(low="green",
                         mid="red",
                         high="black",
                         midpoint = 0.5,
                         limits=v_range,
                         # round(seq(v_range[1],v_range[2],length.out = 5)[1:4],2)
                         breaks=v_breaks1) +
    scale_y_reverse() +
    theme_classic() +
    guides(fill = guide_colourbar(title = gsub("efeito_","",df$name[1]))) +
    coord_cartesian(expand = FALSE) +
    labs(fill=df$name[1]) +
    facet_wrap(~label,ncol = facets,scales="free")
  }
  l_p <- list()
  l_p[[1]] <- df |> 
    filter(label == "Q_0.5") |>
    f_ggplot() + labs(x="")
  l_p[[2]] <- df |> 
    filter(label != "Q_0.5") |>
    f_ggplot()
  ggpubr::ggarrange(plotlist = l_p,nrow=2, common.legend = TRUE, legend="top")
}
l_plot <- dlply(df_plot,"name",f_plot)
p <- grid.arrange(grobs=l_plot,ncol=3)
ggsave("apendices/analise_dados/figuras/FigFinal_contrastes.png",p,
       width = 13,
       height = 9)
```

A figura \@ref(fig:GE-coordenadas-preditoras) apresenta a avaliação visual dos padrão observado na figura \@ref(fig:GE-nCong)

<!-- ```{r estudo shapefile} -->
<!-- library(sf) -->
<!-- df_geomAF <- sf::st_read("./dados/shapefiles/FlorestaAtlantica_limites/biome_border.shx") -->
<!-- df_geomAF %>%  -->
<!--   ggplot() + -->
<!--   geom_sf() -->
<!-- ``` -->



<!-- shapefile do terrabrasilis do INPE (http://terrabrasilis.dpi.inpe.br/en/download-2/) -->

[a]Sugestão para esta seção: 
Primeira parte: propondo uma maneira de interpretar a variação de respostas:
1 - Guiar o leitor pela figura 5, mostrando que há bastante variação na congruência das SADs obtidas das simulações (indique alguns casos emblemáticos apontando alguns dos paineis de algumas paisagens)
2 - Mostre como essa variação pode ser entendida como dois componentes principais: resposta da congruência a K, e diferenças nestas respostas entre as sads obtidas das simulações nas 3 paisagens.
3 - Descreva brevemente cada classe, apontando na figura os paineis que se encaixam nelas. 

Segunda seção: há relações entre as classes de padrões e as variáveis da paisagem?
- Descreva os principais padrões (ou falta deles) de associação de uma ou mais classes com cobertura e estado suceional

Terceira seção: padrões geográficos
há algum padrão na distribuição geográfica dos padrões? Quais? descrever.
[b]acho que é só redação, mas não está claro
[c]o que pode aumentar?
[d]isso me pareceu muito vago
[e]acho que sempre não é apropriado. Sugiro: congruência constante em relação a k, queda da congruência com aumento de k, e aumento da congruência em relação a k. E aí ajudadrai indicar alguns exemplos para cada caso.
[f]variabilidade do que?
[g]usar os termos em português
[h]boas e ruin quanto a que?
[i]melhores no que?
[j]diversidade de que?
[k]acho que isso já é discussão
[l]Explicação: Além disso, a riqueza de espécies arbóreas na Floresta Atlântica muda em função da topografia, latitude e distribuição de tipos de solo (REF). O esforço amostral também deve depender da disponibilidade operacional do estudo, por exemplo, acesso dos locais candidatos em relação aos centros de pesquisa, e do conhecimento prévio dos locais candidatos (REF). A topografia também deve influenciar as variáveis preditoras, proporção de cobertura vegetal (p) e classe de sucessão, pois a capacidade de mecanização da paisagem pode aumentar a chance da paisagem ter baixa proporção de cobertura vegetal e do local amostrado ser em uma área com pouco tempo de regeneração desde o último grande distúrbio (REF).
[m]isso me parece discussão
[n]qual classificação visual? Veja minha sugestão geral a esta seção.
[o]pq chamar de preditoras, se não há um modelo ajustado?
[p]vago. Se vc vê padrão espacila nesta variáveis, pode usar os resultados para descrevê-los
[q]o único padrão é este? Se sim, batas manter isso. Mas se vc vê outras tendências no mapa, importante descrevê-las de maneira tão clara quanto esta
[r]Massa! Te sugiro explicar esta classificação no início desta seção, ver comentários gerai, no título da seção.
[s]por que? descreva algum resultado ou padrão na figura que ajude a sustentar isto
[t]não entendi como estimar fragmentação per se da paisagem observada resolve o problema explicado nas sentenças anteriores.
[u]Não entendi totalmente o propósito desta parte. Suspeito que pode ficar melhor como itemd e discussão
