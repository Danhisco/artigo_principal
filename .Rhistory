facet_wrap(~k_factor, nrow=4) +
labs(x="mudança acumulada de escala (lado da paisagem em km)",
y="cumsum(Ulag)",
title="Os graus de limitação de dispersão apropriados na exensão de 4x4km2 são mais severos ou iguais à k=0.40 em média") +
theme_classic()
df_Usoe |> head()
any(-2:2 < 0)
any(0:2 < 0)
knitr::opts_chunk$set(echo = FALSE, tidy = FALSE, include = TRUE, warning = FALSE,cache = TRUE,message=FALSE,eval=TRUE)
# pacotes
library(lubridate)
library(doMC)
library(raster)
library(bbmle)
library(gridExtra)
library(ggplot2)
library(readr)
library(purrr)
library(stringr)
library(tidyr)
library(plyr)
library(dplyr)
# funções
source("source/dinamica_coalescente.R")
source("source/SoE_MNEE.R")
source("source/f_z.R")
# df dados da proporção de cobertura vegetal
df_p <- read_csv("dados/df_p.csv")
# df dados para simulação
df_sim <- read_csv("dados/df_simulacao.csv") |>
inner_join(x=df_p,by="SiteCode")
# df_sorteio_sitios
df_sorteio_sitios <- read_csv(file="dados/csv/df_sorteio_sitios.csv") |>
select(-d) |>
inner_join(x=select(df_sim,SiteCode,d,k),by="SiteCode")
# v_sim_sites: se precisar é só mover as paisagens de volta ou incluir um programa coalescente na outra pasta
## acabei perdendo a mão e deletei as paisagens nulas de ambas situações, mas tudo bem faz mais em mapas_...Rmd
# v_sim_sites <- list.files(path="dados/simulacao",pattern = "_null.txt")
# file.copy(from=paste0("dados/simulacao/",v_sim_sites),
#           to=paste0("dados/paisagens/paisagens_SoE_MNEE/",v_sim_sites))
# file.remove(paste0("dados/simulacao/",v_sim_sites))
# df_SoE
df_Usoe.rep <- read_csv("dados/csv/df_Usoe.csv") |>
pivot_longer(cols=`1`:`10`, names_to = "n", values_to = "U") |>
inner_join(x=distinct(select(df_sim,SiteCode,effort_ha:S_obs)),by="SiteCode") |>
arrange(S_obs,k)
# df_Unull
df_Unull <- df_Usoe.rep |> filter(round(lado_km) == 16)
# df_Usoe
df_Usoe <- df_Usoe.rep |>
arrange(lado_km) |>
group_by(SiteCode,k,lado_km) |>
summarise(Umed = mean(U),
Umedian = median(U)) |>
mutate(diffU = Umed - Umedian)
f_lag.U <- function(df){
v_Udiff <- diff(range(df$Umed))
df$Ulag <- c((df$Umed[1:(nrow(df)-1)] - df$Umed[2:nrow(df)])/v_Udiff,NA)
df <- df |> mutate(Ulag0 = ifelse(Ulag<0,0,Ulag))
df$Ucsum <- cumsum(df$Ulag)
df$Ucsum0 <- cumsum(df$Ulag0)
df <- df |> mutate(Ucsum0 = ifelse(Ucsum0>1,1,Ucsum0))
return(df)
}
registerDoMC(3)
df_Usoe <- ddply(df_Usoe,c("SiteCode","k"),f_lag.U,.parallel = TRUE)
df_Usoe$Schange <- factor(df_Usoe$lado_km,labels=c(paste(16/(2^(5:1)),"->",16/(2^(4:0))),NA))
df_Usoe$Schange_cumulative <- factor(df_Usoe$lado_km,labels=c(paste(0.5,"->",16/(2^(4:0))),NA))
df_Usoe$k_factor <- factor(round(df_Usoe$k,2),levels = sort(unique(round(df_Usoe$k,2)),decreasing = T))
df_Usoe <- df_Usoe |>
group_by(SiteCode,k) |>
summarise(Ucv = sd(Umed)*100/mean(Umed),
Ulag_neg = any(Ulag < 0)) |>
mutate(Ucv_factor = ifelse(Ucv>10,"top90","low10")) |>
# select(-Ucv) |>
inner_join(x=df_Usoe,by=c("SiteCode","k"))
df_Usoe |> head()
any(-2:2 < 0)
df_Usoe |> summary()
df_Usoe |> filter(Ulag_neg == TRUE) |> dim()
df_Usoe |> filter(Ulag_neg == TRUE) |> head()
df_Usoe |> filter(Ulag_neg == TRUE) |> count(k)
df_Usoe |> filter(Ulag_neg == TRUE) |> count(k) |> ggplot(aes(x=k,y=n)) +geom_point()
knitr::opts_chunk$set(echo = FALSE, tidy = FALSE, include = TRUE, warning = FALSE,cache = TRUE,message=FALSE,eval=TRUE)
# pacotes
library(lubridate)
library(doMC)
library(raster)
library(bbmle)
library(gridExtra)
library(ggplot2)
library(readr)
library(purrr)
library(stringr)
library(tidyr)
library(plyr)
library(dplyr)
# funções
source("source/dinamica_coalescente.R")
source("source/SoE_MNEE.R")
source("source/f_z.R")
# df dados da proporção de cobertura vegetal
df_p <- read_csv("dados/df_p.csv")
# df dados para simulação
df_sim <- read_csv("dados/df_simulacao.csv") |>
inner_join(x=df_p,by="SiteCode")
# df_sorteio_sitios
df_sorteio_sitios <- read_csv(file="dados/csv/df_sorteio_sitios.csv") |>
select(-d) |>
inner_join(x=select(df_sim,SiteCode,d,k),by="SiteCode")
# v_sim_sites: se precisar é só mover as paisagens de volta ou incluir um programa coalescente na outra pasta
## acabei perdendo a mão e deletei as paisagens nulas de ambas situações, mas tudo bem faz mais em mapas_...Rmd
# v_sim_sites <- list.files(path="dados/simulacao",pattern = "_null.txt")
# file.copy(from=paste0("dados/simulacao/",v_sim_sites),
#           to=paste0("dados/paisagens/paisagens_SoE_MNEE/",v_sim_sites))
# file.remove(paste0("dados/simulacao/",v_sim_sites))
# df_SoE
df_Usoe.rep <- read_csv("dados/csv/df_Usoe.csv") |>
pivot_longer(cols=`1`:`10`, names_to = "n", values_to = "U") |>
inner_join(x=distinct(select(df_sim,SiteCode,effort_ha:S_obs)),by="SiteCode") |>
arrange(S_obs,k)
# df_Unull
df_Unull <- df_Usoe.rep |> filter(round(lado_km) == 16)
# df_Usoe
df_Usoe <- df_Usoe.rep |>
arrange(lado_km) |>
group_by(SiteCode,k,lado_km) |>
summarise(Umed = mean(U),
Umedian = median(U)) |>
mutate(diffU = Umed - Umedian)
f_lag.U <- function(df){
v_Udiff <- diff(range(df$Umed))
df$Ulag <- c((df$Umed[1:(nrow(df)-1)] - df$Umed[2:nrow(df)])/v_Udiff,NA)
df <- df |> mutate(Ulag0 = ifelse(Ulag<0,0,Ulag))
df$Ucsum <- cumsum(df$Ulag)
df$Ucsum0 <- cumsum(df$Ulag0)
df <- df |> mutate(Ucsum0 = ifelse(Ucsum0>1,1,Ucsum0))
return(df)
}
registerDoMC(3)
df_Usoe <- ddply(df_Usoe,c("SiteCode","k"),f_lag.U,.parallel = TRUE)
df_Usoe$Schange <- factor(df_Usoe$lado_km,labels=c(paste(16/(2^(5:1)),"->",16/(2^(4:0))),NA))
df_Usoe$Schange_cumulative <- factor(df_Usoe$lado_km,labels=c(paste(0.5,"->",16/(2^(4:0))),NA))
df_Usoe$k_factor <- factor(round(df_Usoe$k,2),levels = sort(unique(round(df_Usoe$k,2)),decreasing = T))
df_Usoe <- df_Usoe |>
group_by(SiteCode,k) |>
summarise(Ucv = sd(Umed)*100/mean(Umed),
Ulag_neg = any(Ulag < -0.1)) |>
mutate(Ucv_factor = ifelse(Ucv>10,"top90","low10")) |>
# select(-Ucv) |>
inner_join(x=df_Usoe,by=c("SiteCode","k"))
df_Usoe |> dim()
df_Usoe |> filter(Ulag_neg == TRUE) |> dim()
df_Usoe |> head()
drop_na() |>
# filter(Ucv_factor == "top90") |>
filter(Ulag_neg == TRUE) |>
ggplot(aes(x=Schange_cumulative,y=Ucsum)) +
geom_point(position = position_jitter(w = 0.1, h = 0),alpha=0.5) +
geom_boxplot(aes(group=Schange_cumulative)) +
geom_smooth(aes(group=1),method = "loess",se=F,color="black") +
stat_summary(fun.data = mean_se,color="red",size=0.2) +
geom_hline(yintercept = 0.9, color="blue") +
facet_wrap(~k_factor, nrow=4) +
labs(x="mudança acumulada de escala (lado da paisagem em km)",
y="cumsum(Ulag)",
title="Os graus de limitação de dispersão apropriados na exensão de 4x4km2 são mais severos ou iguais à k=0.40 em média") +
theme_classic()
df_Usoe |>
drop_na() |>
# filter(Ucv_factor == "top90") |>
filter(Ulag_neg == TRUE) |>
ggplot(aes(x=Schange_cumulative,y=Ucsum)) +
geom_point(position = position_jitter(w = 0.1, h = 0),alpha=0.5) +
geom_boxplot(aes(group=Schange_cumulative)) +
geom_smooth(aes(group=1),method = "loess",se=F,color="black") +
stat_summary(fun.data = mean_se,color="red",size=0.2) +
geom_hline(yintercept = 0.9, color="blue") +
facet_wrap(~k_factor, nrow=4) +
labs(x="mudança acumulada de escala (lado da paisagem em km)",
y="cumsum(Ulag)",
title="Os graus de limitação de dispersão apropriados na exensão de 4x4km2 são mais severos ou iguais à k=0.40 em média") +
theme_classic()
df_Usoe |>
drop_na() |>
# filter(Ucv_factor == "top90") |>
filter(Ulag_neg == FALSE) |>
ggplot(aes(x=Schange_cumulative,y=Ucsum)) +
geom_point(position = position_jitter(w = 0.1, h = 0),alpha=0.5) +
geom_boxplot(aes(group=Schange_cumulative)) +
geom_smooth(aes(group=1),method = "loess",se=F,color="black") +
stat_summary(fun.data = mean_se,color="red",size=0.2) +
geom_hline(yintercept = 0.9, color="blue") +
facet_wrap(~k_factor, nrow=4) +
labs(x="mudança acumulada de escala (lado da paisagem em km)",
y="cumsum(Ulag)",
title="Os graus de limitação de dispersão apropriados na exensão de 4x4km2 são mais severos ou iguais à k=0.40 em média") +
theme_classic()
df_Usoe |>
drop_na() |>
# filter(Ucv_factor == "top90") |>
filter(Ulag_neg == NA) |>
ggplot(aes(x=Schange_cumulative,y=Ucsum)) +
geom_point(position = position_jitter(w = 0.1, h = 0),alpha=0.5) +
geom_boxplot(aes(group=Schange_cumulative)) +
geom_smooth(aes(group=1),method = "loess",se=F,color="black") +
stat_summary(fun.data = mean_se,color="red",size=0.2) +
geom_hline(yintercept = 0.9, color="blue") +
facet_wrap(~k_factor, nrow=4) +
labs(x="mudança acumulada de escala (lado da paisagem em km)",
y="cumsum(Ulag)",
title="Os graus de limitação de dispersão apropriados na exensão de 4x4km2 são mais severos ou iguais à k=0.40 em média") +
theme_classic()
df_Usoe |>
filter(Ulag_neg == NA) |>
drop_na() |>
# filter(Ucv_factor == "top90") |>
ggplot(aes(x=Schange_cumulative,y=Ucsum)) +
geom_point(position = position_jitter(w = 0.1, h = 0),alpha=0.5) +
geom_boxplot(aes(group=Schange_cumulative)) +
geom_smooth(aes(group=1),method = "loess",se=F,color="black") +
stat_summary(fun.data = mean_se,color="red",size=0.2) +
geom_hline(yintercept = 0.9, color="blue") +
facet_wrap(~k_factor, nrow=4) +
labs(x="mudança acumulada de escala (lado da paisagem em km)",
y="cumsum(Ulag)",
title="Os graus de limitação de dispersão apropriados na exensão de 4x4km2 são mais severos ou iguais à k=0.40 em média") +
theme_classic()
df_Usoe$Ulag_neg |> unique()
df_Usoe |>
filter(is.na(Ulag_neg)) |>
drop_na() |>
# filter(Ucv_factor == "top90") |>
ggplot(aes(x=Schange_cumulative,y=Ucsum)) +
geom_point(position = position_jitter(w = 0.1, h = 0),alpha=0.5) +
geom_boxplot(aes(group=Schange_cumulative)) +
geom_smooth(aes(group=1),method = "loess",se=F,color="black") +
stat_summary(fun.data = mean_se,color="red",size=0.2) +
geom_hline(yintercept = 0.9, color="blue") +
facet_wrap(~k_factor, nrow=4) +
labs(x="mudança acumulada de escala (lado da paisagem em km)",
y="cumsum(Ulag)",
title="Os graus de limitação de dispersão apropriados na exensão de 4x4km2 são mais severos ou iguais à k=0.40 em média") +
theme_classic()
df_Usoe |>
filter(is.na(Ulag_neg))
knitr::opts_chunk$set(echo = FALSE, tidy = FALSE, include = TRUE, warning = FALSE,cache = TRUE,message=FALSE,eval=TRUE)
# pacotes
library(lubridate)
library(doMC)
library(raster)
library(bbmle)
library(gridExtra)
library(ggplot2)
library(readr)
library(purrr)
library(stringr)
library(tidyr)
library(plyr)
library(dplyr)
# funções
source("source/dinamica_coalescente.R")
source("source/SoE_MNEE.R")
source("source/f_z.R")
# df dados da proporção de cobertura vegetal
df_p <- read_csv("dados/df_p.csv")
# df dados para simulação
df_sim <- read_csv("dados/df_simulacao.csv") |>
inner_join(x=df_p,by="SiteCode")
# df_sorteio_sitios
df_sorteio_sitios <- read_csv(file="dados/csv/df_sorteio_sitios.csv") |>
select(-d) |>
inner_join(x=select(df_sim,SiteCode,d,k),by="SiteCode")
# v_sim_sites: se precisar é só mover as paisagens de volta ou incluir um programa coalescente na outra pasta
## acabei perdendo a mão e deletei as paisagens nulas de ambas situações, mas tudo bem faz mais em mapas_...Rmd
# v_sim_sites <- list.files(path="dados/simulacao",pattern = "_null.txt")
# file.copy(from=paste0("dados/simulacao/",v_sim_sites),
#           to=paste0("dados/paisagens/paisagens_SoE_MNEE/",v_sim_sites))
# file.remove(paste0("dados/simulacao/",v_sim_sites))
# df_SoE
df_Usoe.rep <- read_csv("dados/csv/df_Usoe.csv") |>
pivot_longer(cols=`1`:`10`, names_to = "n", values_to = "U") |>
inner_join(x=distinct(select(df_sim,SiteCode,effort_ha:S_obs)),by="SiteCode") |>
arrange(S_obs,k)
# df_Unull
df_Unull <- df_Usoe.rep |> filter(round(lado_km) == 16)
# df_Usoe
df_Usoe <- df_Usoe.rep |>
arrange(lado_km) |>
group_by(SiteCode,k,lado_km) |>
summarise(Umed = mean(U),
Umedian = median(U)) |>
mutate(diffU = Umed - Umedian)
f_lag.U <- function(df){
v_Udiff <- diff(range(df$Umed))
df$Ulag <- c((df$Umed[1:(nrow(df)-1)] - df$Umed[2:nrow(df)])/v_Udiff,NA)
df <- df |> mutate(Ulag0 = ifelse(Ulag<0,0,Ulag))
df$Ucsum <- cumsum(df$Ulag)
df$Ucsum0 <- cumsum(df$Ulag0)
df <- df |> mutate(Ucsum0 = ifelse(Ucsum0>1,1,Ucsum0))
return(df)
}
registerDoMC(3)
df_Usoe <- ddply(df_Usoe,c("SiteCode","k"),f_lag.U,.parallel = TRUE)
df_Usoe$Schange <- factor(df_Usoe$lado_km,labels=c(paste(16/(2^(5:1)),"->",16/(2^(4:0))),NA))
df_Usoe$Schange_cumulative <- factor(df_Usoe$lado_km,labels=c(paste(0.5,"->",16/(2^(4:0))),NA))
df_Usoe$k_factor <- factor(round(df_Usoe$k,2),levels = sort(unique(round(df_Usoe$k,2)),decreasing = T))
df_Usoe <- df_Usoe |>
group_by(SiteCode,k) |>
summarise(Ucv = sd(Umed)*100/mean(Umed),
Ulag_f = ifelse(any(Ulag < -0.1),"neg_v","pos_v")) |>
mutate(Ucv_f = ifelse(Ucv>10,"top90","low10")) |>
# select(-Ucv) |>
inner_join(x=df_Usoe,by=c("SiteCode","k"))
df_Usoe |> summary()
df_Usoe |>
drop_na() |>
filter(Ulag_neg == "pos_v") |>
# filter(Ucv_factor == "top90") |>
ggplot(aes(x=Schange_cumulative,y=Ucsum)) +
geom_point(position = position_jitter(w = 0.1, h = 0),alpha=0.5) +
geom_boxplot(aes(group=Schange_cumulative)) +
geom_smooth(aes(group=1),method = "loess",se=F,color="black") +
stat_summary(fun.data = mean_se,color="red",size=0.2) +
geom_hline(yintercept = 0.9, color="blue") +
facet_wrap(~k_factor, nrow=4) +
labs(x="mudança acumulada de escala (lado da paisagem em km)",
y="cumsum(Ulag)",
title="Os graus de limitação de dispersão apropriados na exensão de 4x4km2 são mais severos ou iguais à k=0.40 em média") +
theme_classic()
df_Usoe |>
drop_na() |>
filter(Ulag_f == "pos_v") |>
# filter(Ucv_factor == "top90") |>
ggplot(aes(x=Schange_cumulative,y=Ucsum)) +
geom_point(position = position_jitter(w = 0.1, h = 0),alpha=0.5) +
geom_boxplot(aes(group=Schange_cumulative)) +
geom_smooth(aes(group=1),method = "loess",se=F,color="black") +
stat_summary(fun.data = mean_se,color="red",size=0.2) +
geom_hline(yintercept = 0.9, color="blue") +
facet_wrap(~k_factor, nrow=4) +
labs(x="mudança acumulada de escala (lado da paisagem em km)",
y="cumsum(Ulag)",
title="Os graus de limitação de dispersão apropriados na exensão de 4x4km2 são mais severos ou iguais à k=0.40 em média") +
theme_classic()
df_Usoe |>
drop_na() |>
filter(Ulag_f == "pos_v") |> dim()
df_Usoe$Ulag_f |> unique()
knitr::opts_chunk$set(echo = FALSE, tidy = FALSE, include = TRUE, warning = FALSE,cache = TRUE,message=FALSE,eval=TRUE)
# pacotes
library(lubridate)
library(doMC)
library(raster)
library(bbmle)
library(gridExtra)
library(ggplot2)
library(readr)
library(purrr)
library(stringr)
library(tidyr)
library(plyr)
library(dplyr)
# funções
source("source/dinamica_coalescente.R")
source("source/SoE_MNEE.R")
source("source/f_z.R")
# df dados da proporção de cobertura vegetal
df_p <- read_csv("dados/df_p.csv")
# df dados para simulação
df_sim <- read_csv("dados/df_simulacao.csv") |>
inner_join(x=df_p,by="SiteCode")
# df_sorteio_sitios
df_sorteio_sitios <- read_csv(file="dados/csv/df_sorteio_sitios.csv") |>
select(-d) |>
inner_join(x=select(df_sim,SiteCode,d,k),by="SiteCode")
# v_sim_sites: se precisar é só mover as paisagens de volta ou incluir um programa coalescente na outra pasta
## acabei perdendo a mão e deletei as paisagens nulas de ambas situações, mas tudo bem faz mais em mapas_...Rmd
# v_sim_sites <- list.files(path="dados/simulacao",pattern = "_null.txt")
# file.copy(from=paste0("dados/simulacao/",v_sim_sites),
#           to=paste0("dados/paisagens/paisagens_SoE_MNEE/",v_sim_sites))
# file.remove(paste0("dados/simulacao/",v_sim_sites))
# df_SoE
df_Usoe.rep <- read_csv("dados/csv/df_Usoe.csv") |>
pivot_longer(cols=`1`:`10`, names_to = "n", values_to = "U") |>
inner_join(x=distinct(select(df_sim,SiteCode,effort_ha:S_obs)),by="SiteCode") |>
arrange(S_obs,k)
# df_Unull
df_Unull <- df_Usoe.rep |> filter(round(lado_km) == 16)
# df_Usoe
df_Usoe <- df_Usoe.rep |>
arrange(lado_km) |>
group_by(SiteCode,k,lado_km) |>
summarise(Umed = mean(U),
Umedian = median(U)) |>
mutate(diffU = Umed - Umedian)
f_lag.U <- function(df){
v_Udiff <- diff(range(df$Umed))
df$Ulag <- c((df$Umed[1:(nrow(df)-1)] - df$Umed[2:nrow(df)])/v_Udiff,NA)
df <- df |> mutate(Ulag0 = ifelse(Ulag<0,0,Ulag))
df$Ucsum <- cumsum(df$Ulag)
df$Ucsum0 <- cumsum(df$Ulag0)
df <- df |> mutate(Ucsum0 = ifelse(Ucsum0>1,1,Ucsum0))
return(df)
}
registerDoMC(3)
df_Usoe <- ddply(df_Usoe,c("SiteCode","k"),f_lag.U,.parallel = TRUE)
df_Usoe$Schange <- factor(df_Usoe$lado_km,labels=c(paste(16/(2^(5:1)),"->",16/(2^(4:0))),NA))
df_Usoe$Schange_cumulative <- factor(df_Usoe$lado_km,labels=c(paste(0.5,"->",16/(2^(4:0))),NA))
df_Usoe$k_factor <- factor(round(df_Usoe$k,2),levels = sort(unique(round(df_Usoe$k,2)),decreasing = T))
df_Usoe <- df_Usoe |>
group_by(SiteCode,k) |>
summarise(Ucv = sd(Umed)*100/mean(Umed),
Ulag_f = ifelse(any(Ulag < -0.1,na.rm = T),"neg_v","pos_v")) |>
mutate(Ucv_f = ifelse(Ucv>10,"top90","low10")) |>
# select(-Ucv) |>
inner_join(x=df_Usoe,by=c("SiteCode","k"))
df_Usoe$Ulag_f |> unique()
df_Usoe |>
drop_na() |>
filter(Ulag_f == "pos_v") |>
# filter(Ucv_factor == "top90") |>
ggplot(aes(x=Schange_cumulative,y=Ucsum)) +
geom_point(position = position_jitter(w = 0.1, h = 0),alpha=0.5) +
geom_boxplot(aes(group=Schange_cumulative)) +
geom_smooth(aes(group=1),method = "loess",se=F,color="black") +
stat_summary(fun.data = mean_se,color="red",size=0.2) +
geom_hline(yintercept = 0.9, color="blue") +
facet_wrap(~k_factor, nrow=4) +
labs(x="mudança acumulada de escala (lado da paisagem em km)",
y="cumsum(Ulag)",
title="Os graus de limitação de dispersão apropriados na exensão de 4x4km2 são mais severos ou iguais à k=0.40 em média") +
theme_classic()
df_Usoe |>
drop_na() |>
# filter(Ulag_f == "pos_v") |>
# filter(Ucv_factor == "top90") |>
ggplot(aes(x=Schange_cumulative,y=Ucsum)) +
geom_point(position = position_jitter(w = 0.1, h = 0),alpha=0.5) +
geom_boxplot(aes(group=Schange_cumulative)) +
geom_smooth(aes(group=1),method = "loess",se=F,color="black") +
stat_summary(fun.data = mean_se,color="red",size=0.2) +
geom_hline(yintercept = 0.9, color="blue") +
facet_wrap(~k_factor, nrow=4) +
labs(x="mudança acumulada de escala (lado da paisagem em km)",
y="cumsum(Ulag)",
title="Os graus de limitação de dispersão apropriados na exensão de 4x4km2 são mais severos ou iguais à k=0.40 em média") +
theme_classic()
df_Usoe |>
drop_na() |>
filter(Ulag_f == "pos_v") |>
# filter(Ucv_factor == "top90") |>
ggplot(aes(x=Schange_cumulative,y=Ucsum)) +
geom_point(position = position_jitter(w = 0.1, h = 0),alpha=0.5) +
geom_boxplot(aes(group=Schange_cumulative)) +
geom_smooth(aes(group=1),method = "loess",se=F,color="black") +
stat_summary(fun.data = mean_se,color="red",size=0.2) +
geom_hline(yintercept = 0.9, color="blue") +
facet_wrap(~k_factor, nrow=4) +
labs(x="mudança acumulada de escala (lado da paisagem em km)",
y="cumsum(Ulag)",
title="Os graus de limitação de dispersão apropriados na exensão de 4x4km2 são mais severos ou iguais à k=0.40 em média") +
theme_classic()
df_Usoe |> head()
df_Usoe |> head(n=20)
df_Usoe |> tail(n=20)
df_Usoe |>
drop_na() |>
# filter(Ulag_f == "pos_v") |>
# filter(Ucv_factor == "top90") |>
ggplot(aes(x=Schange_cumulative,y=Ucsum0)) +
geom_point(position = position_jitter(w = 0.1, h = 0),alpha=0.5) +
geom_boxplot(aes(group=Schange_cumulative)) +
geom_smooth(aes(group=1),method = "loess",se=F,color="black") +
stat_summary(fun.data = mean_se,color="red",size=0.2) +
geom_hline(yintercept = 0.9, color="blue") +
facet_wrap(~k_factor, nrow=4) +
labs(x="mudança acumulada de escala (lado da paisagem em km)",
y="cumsum(Ulag)",
title="Os graus de limitação de dispersão apropriados na exensão de 4x4km2 são mais severos ou iguais à k=0.40 em média") +
theme_classic()
df_Usoe |>
drop_na() |>
# filter(Ulag_f == "pos_v") |>
# filter(Ucv_factor == "top90") |>
ggplot(aes(x=Schange_cumulative,y=Ucsum)) +
geom_point(position = position_jitter(w = 0.1, h = 0),alpha=0.5) +
geom_boxplot(aes(group=Schange_cumulative)) +
geom_smooth(aes(group=1),method = "loess",se=F,color="black") +
stat_summary(fun.data = mean_se,color="red",size=0.2) +
geom_hline(yintercept = 0.9, color="blue") +
facet_wrap(~k_factor, nrow=4) +
labs(x="mudança acumulada de escala (lado da paisagem em km)",
y="cumsum(Ulag)",
title="Os graus de limitação de dispersão apropriados na exensão de 4x4km2 são mais severos ou iguais à k=0.40 em média") +
theme_classic()
df_Usoe |>
drop_na() |>
# filter(Ulag_f == "pos_v") |>
# filter(Ucv_factor == "top90") |>
ggplot(aes(x=Schange_cumulative,y=Ucsum)) +
geom_point(position = position_jitter(w = 0.1, h = 0),alpha=0.5) +
geom_boxplot(aes(group=Schange_cumulative)) +
geom_smooth(aes(group=1),method = "loess",se=F,color="black") +
stat_summary(fun.data = mean_se,color="red",size=0.2) +
geom_hline(yintercept = 0.9, color="blue") +
facet_wrap(~k_factor, nrow=4) +
labs(x="mudança acumulada de escala (lado da paisagem em km)",
y="cumsum(Ulag)",
title="Os graus de limitação de dispersão apropriados na exensão de 4x4km2 são mais severos ou iguais à k=0.40 em média") +
theme_classic()
rle
